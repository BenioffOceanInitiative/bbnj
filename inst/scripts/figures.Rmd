---
title: "figures"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE)
```

```{r}
devtools::load_all()
library(tidyverse)
library(ggplot2)
```

```{r}

#Read in csv of report from scenario 4
targets <- readr::read_csv("inst/app/www/scenarios/s04a.biofish.alltime.mol50km_rep.csv") %>% 
## Add row for all seamounts together
  bind_rows(
    targets %>%
      filter(feature %in% c("phys_seamounts_gt200to800m", "phys_seamounts_gt800m", "phys_seamounts_0to200m")) %>%
      summarise_at("relative_held", mean) %>% 
      mutate(feature="phys_seamounts_all") 
  )

targetsfig1<-dplyr::filter(targets, feature %in% c("phys_seamounts_all","phys_vents","bio_vgpm","scapes_hetero"))

targetsfig1labels <- c(phys_seamounts_all = "Seamounts", phys_vents = "Hydrothermal Vents", bio_vgpm = "Primary Productivity",scapes_hetero="Benthic Heterogeneity")


ggplot(targetsfig1,aes(x=reorder(feature, relative_held),y=relative_held,label=scales::percent(relative_held)))+
  geom_bar(stat="identity",width=0.5,fill="#4ba4b1")+
  geom_hline(yintercept=0.3, linetype="dotted")+
  coord_flip()+
  scale_y_continuous(limits = c(0, 1),labels = scales::percent)+
  scale_x_discrete(labels = targetsfig1labels)+
  xlab("Conservation Feature")+
  ylab("Percentage Included in Solution")+
  geom_text(hjust = -0.4)


targetsfig2<-dplyr::filter(targets, feature %in% c("nspp_corals","nspp_seagrasses","nspp_sharks.n.rays","nspp_cetaceans","X2100_nspp_corals","X2100_nspp_seagrasses","X2100_nspp_sharks.n.rays","X2100_nspp_cetaceans"))

targetsfig2labels <- c(nspp_corals = "Corals",nspp_cetaceans = "Cetaceans",nspp_sharks.n.rays = "Sharks and Rays", nspp_seagrasses = "Seagrasses",X2100_nspp_corals= "Corals 2100",X2100_nspp_cetaceans = "Cetaceans 2100",X2100_nspp_sharks.n.rays = "Sharks and Rays 2100",X2100_nspp_seagrasses = "Seagrasses 2100")


ggplot(targetsfig2,aes(x=reorder(feature, relative_held),y=relative_held,label=scales::percent(relative_held)))+
  geom_bar(stat="identity",width=0.5,fill="#4ba4b1")+
  geom_hline(yintercept=0.3, linetype="dotted")+
  coord_flip()+
  scale_y_continuous(limits = c(0, 1),labels = scales::percent)+
  scale_x_discrete(labels = targetsfig2labels)+
  xlab("Conservation Feature")+
  ylab("Percentage Included in Solution")+
  geom_text(hjust = -0.4)

```

