<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Explore prioritizr • bbnj</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Explore prioritizr" />

<meta property="og:description" content="" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-article">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bbnj</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/load_rasters.html">Vignette Title</a>
    </li>
    <li>
      <a href="../articles/prep_climate_ubc.html">Prep climate UBC data</a>
    </li>
    <li>
      <a href="../articles/prioritizr_explore.html">Explore prioritizr</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ecoquants/bbnj">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>


<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Explore prioritizr</h1>
                        <h4 class="author">Ben Best</h4>
            
            <h4 class="date">2019-03-04</h4>
      
      <small class="dont-index">Source: <a href='https://github.com/ecoquants/bbnj/blob/master/vignettes/prioritizr_explore.Rmd'><code>vignettes/prioritizr_explore.Rmd</code></a></small>
      <div class="hidden name"><code>prioritizr_explore.Rmd</code></div>

    </div>

    
    
<div id="setup" class="section level2">
<h2>Setup</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suppressPackageStartupMessages</span>({
  <span class="kw">library</span>(tidyverse)
  <span class="kw">library</span>(here)
  <span class="kw">library</span>(glue)
  <span class="kw">library</span>(raster)
  <span class="kw">library</span>(sf)
  <span class="kw">library</span>(leaflet)
  <span class="kw">library</span>(RColorBrewer)
  <span class="kw">library</span>(rasterVis)
  <span class="kw">library</span>(prioritizr) <span class="co"># install.packages(&quot;prioritizr&quot;)</span>
  
  <span class="co">#library(bbnj)</span>
  devtools<span class="op">::</span><span class="kw">load_all</span>()
})

dir_data       &lt;-<span class="st"> &quot;~/Gdrive Ecoquants/projects/bbnj/data&quot;</span>
cell_res       &lt;-<span class="st"> </span><span class="fl">0.5</span>  <span class="co"># n=  113,401</span>
p_boundary_shp &lt;-<span class="st"> </span><span class="kw">glue</span>(<span class="st">&quot;{dir_data}/derived/boundary/high_seas.shp&quot;</span>)
r_pu_id_tif    &lt;-<span class="st"> </span><span class="kw">glue</span>(<span class="st">&quot;{dir_data}/derived/boundary/high_seas_cellid_{cell_res}dd.tif&quot;</span>)</code></pre></div>
</div>
<div id="planning-units" class="section level2">
<h2>Planning Units</h2>
<p>Using half-degree global raster (resolution of AquaMaps, GFW, …).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get planning unit raster</span>
r_pu_id &lt;-<span class="st"> </span><span class="kw">raster</span>(r_pu_id_tif)

pal &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">brewer.pal</span>(<span class="dv">11</span>, <span class="st">&quot;Spectral&quot;</span>))
cols &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">pal</span>(<span class="dv">255</span>))
<span class="kw">plot</span>(r_pu_id, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">&quot;pu_id&quot;</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-1-1.png" width="691.2" /></p>
<div id="pu-cost-as-area" class="section level3">
<h3>PU Cost as Area</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r_pu_area &lt;-<span class="st"> </span><span class="kw">area</span>(r_pu_id) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># in km2</span>
<span class="st">  </span><span class="kw">mask</span>(r_pu_id)

<span class="kw">plot</span>(r_pu_area, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">&quot;pu_area (km2)&quot;</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-2-1.png" width="691.2" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A &lt;-<span class="st"> </span><span class="kw">cellStats</span>(r_pu_area, <span class="st">&quot;sum&quot;</span>)
r_pu_areas &lt;-<span class="st"> </span>r_pu_area <span class="op">/</span><span class="st"> </span>A <span class="op">*</span><span class="st"> </span><span class="dv">100</span>
<span class="co">#cellStats(r_pu_areas, &quot;sum&quot;) # 100</span>

<span class="kw">plot</span>(r_pu_areas, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">&quot;pu_areas (sums to 100)&quot;</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-3-1.png" width="691.2" /></p>
</div>
</div>
<div id="conservation-targets" class="section level2">
<h2>Conservation Targets</h2>
<div id="biodiversity" class="section level3">
<h3>Biodiversity</h3>
<p>All the species distribution data was generously provided as comma-seperated value (csv) files in a zip package <code>aquamaps_ver0816c.zip</code> by Kristin Kaschner and Cristina Garilao to Ben Best <a href="mailto:ben@ecoquants.com">ben@ecoquants.com</a> on Jun 21, 2018 from the extensive work available at <a href="http://AquaMaps.org" class="uri">http://AquaMaps.org</a> to be fully cited <span class="citation">(K. Kaschner et al. 2016)</span> whenever used. For details on generating indicators, see <a href="https://marinebon.github.io/gmbi/articles/calc.html">Calculate Indicators • gmbi</a>:</p>
<p>Note that a probability ≥ 0.5 was used to convert AquaMaps relative environmental suitability (RES) from continuous [0 - 1] to binary [0,1] <span class="citation">(Klein et al. 2015; O’Hara et al. 2017)</span>.</p>
<ul>
<li><p><code>nspp</code>: number of species, ie species richness</p></li>
<li><p><code>rls</code>: Red List Sum (RLS)</p></li>
</ul>
<p>The Red List Sum (RLS) is the numerator from the Red List Index (RLI) (<span class="citation">(Butchart et al. 2007; Juslén et al. 2016)</span>:</p>
<p><span class="math display">\[RLS = \sum_{i=1}^{n_{spp}} w_i\]</span></p>
<p>We will use only the numerator, the Red List Sum (RLS), of the Red List Index (RLI) to quantify the “endangeredness” of a cell without dilution from being in a species-rich place as the RLI does when averaging the extinction risk for all assessed species. For more details see <a href="https://marinebon.github.io/gmbi/articles/calc.html#calculate-extinction-risk">Calculate extinction risk - Calculate Indicators • gmbi</a>.</p>
<p>These indicators were calculated for all species as well as taxonomic groups defined in <a href="https://marinebon.github.io/gmbi/articles/calc.html#assign-taxonomic-groups">Assign taxonomic groups - Calculate Indicators • gmbi</a>.</p>
<p>With rasters from R package <a href="https://github.com/marinebon/gmbi">marinebon/gmbi</a>, mask rasters to high seas planning units and save into this R package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gmbi) <span class="co"># devtools::install_github(&quot;marinebon/gmbi&quot;)</span>

dir_bio &lt;-<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;inst/data/biodiversity&quot;</span>)
redo =<span class="st"> </span>F

tifs_gmbi &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="kw">system.file</span>(<span class="st">&quot;rasters&quot;</span>, <span class="dt">package=</span><span class="st">&quot;gmbi&quot;</span>), <span class="dt">full.names =</span> T)
tifs_bbnj &lt;-<span class="st"> </span><span class="kw">file.path</span>(dir_bio, <span class="kw">basename</span>(tifs_gmbi))

<span class="cf">if</span> (<span class="op">!</span><span class="kw">all</span>(<span class="kw">file.exists</span>(tifs_bbnj)) <span class="op">|</span><span class="st"> </span>redo){
  
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(tifs_gmbi)){ <span class="co"># i=27</span>
    
    tif_gmbi &lt;-<span class="st"> </span>tifs_gmbi[i]
    tif_bbnj &lt;-<span class="st"> </span>tifs_bbnj[i]
    
    r &lt;-<span class="st"> </span><span class="kw">raster</span>(tif_gmbi) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw">mask</span>(r_pu_id)
    
    <span class="co"># in some cases masking by high seas might return all NAs, in which case skip</span>
    <span class="cf">if</span> (<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(<span class="kw">values</span>(r))) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="cf">next</span>()
    
    <span class="kw">writeRaster</span>(r, tif_bbnj, <span class="dt">overwrite=</span>T)
  }
}

<span class="kw">basename</span>(tifs_bbnj)</code></pre></div>
<pre><code>##  [1] &quot;nspp_all.tif&quot;                   &quot;nspp_bivalves.tif&quot;             
##  [3] &quot;nspp_chitons.tif&quot;               &quot;nspp_coastal.fishes.tif&quot;       
##  [5] &quot;nspp_corals.tif&quot;                &quot;nspp_crustaceans.tif&quot;          
##  [7] &quot;nspp_echinoderms.tif&quot;           &quot;nspp_euphausiids.tif&quot;          
##  [9] &quot;nspp_gastropods.tif&quot;            &quot;nspp_hydrozoans.tif&quot;           
## [11] &quot;nspp_mangroves.tif&quot;             &quot;nspp_na.tif&quot;                   
## [13] &quot;nspp_non-squid.cephalopods.tif&quot; &quot;nspp_pinnipeds.tif&quot;            
## [15] &quot;nspp_reptiles.tif&quot;              &quot;nspp_sea.spiders.tif&quot;          
## [17] &quot;nspp_seagrasses.tif&quot;            &quot;nspp_sharks.tif&quot;               
## [19] &quot;nspp_sponges.tif&quot;               &quot;nspp_tunas.n.billfishes.tif&quot;   
## [21] &quot;nspp_tunicates.tif&quot;             &quot;nspp_worms.tif&quot;                
## [23] &quot;rls_all.tif&quot;                    &quot;rls_bivalves.tif&quot;              
## [25] &quot;rls_coastal.fishes.tif&quot;         &quot;rls_corals.tif&quot;                
## [27] &quot;rls_crustaceans.tif&quot;            &quot;rls_echinoderms.tif&quot;           
## [29] &quot;rls_gastropods.tif&quot;             &quot;rls_na.tif&quot;                    
## [31] &quot;rls_non-squid.cephalopods.tif&quot;  &quot;rls_pinnipeds.tif&quot;             
## [33] &quot;rls_reptiles.tif&quot;               &quot;rls_sharks.tif&quot;                
## [35] &quot;rls_tunas.n.billfishes.tif&quot;</code></pre>
</div>
<div id="nspp-all-taxa" class="section level3">
<h3><code>nspp</code>, all taxa</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tif &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;data/biodiversity/nspp_all.tif&quot;</span>, <span class="dt">package=</span><span class="st">&quot;bbnj&quot;</span>)
r_nspp_all &lt;-<span class="st"> </span><span class="kw">raster</span>(tif)
<span class="kw">plot</span>(r_nspp_all, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">&quot;nspp, all taxa&quot;</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-5-1.png" width="691.2" /></p>
</div>
<div id="nspp-all-taxa-area-scaled" class="section level3">
<h3><code>nspp</code>, all taxa, area scaled</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r_nspp_all_as &lt;-<span class="st"> </span><span class="kw">area_scale_raster</span>(r_nspp_all, r_pu_area)

<span class="kw">plot</span>(r_nspp_all_as, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">&quot;nspp, all taxa, area scaled&quot;</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-6-1.png" width="691.2" /></p>
</div>
<div id="nspp-by-taxonomic-group" class="section level3">
<h3><code>nspp</code>, by taxonomic group</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get all tifs, except first one &quot;nspp_all.tif&quot;</span>
tifs &lt;-<span class="st"> </span><span class="kw">list.files</span>(
  <span class="kw">system.file</span>(<span class="st">&quot;data/biodiversity&quot;</span>, <span class="dt">package=</span><span class="st">&quot;bbnj&quot;</span>), 
  <span class="st">&quot;^nspp_.*.tif$&quot;</span>, <span class="dt">full.names =</span> T)[<span class="op">-</span><span class="dv">1</span>]
s_nspp_groups &lt;-<span class="st"> </span><span class="kw">stack</span>(tifs)
<span class="kw">names</span>(s_nspp_groups) &lt;-<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">names</span>(s_nspp_groups), <span class="st">&quot;nspp_&quot;</span>, <span class="st">&quot;&quot;</span>)
<span class="kw">plot</span>(s_nspp_groups, <span class="dt">col =</span> cols)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-7-1.png" width="691.2" /></p>
</div>
<div id="rls-all-taxa" class="section level3">
<h3><code>rls</code>, all taxa</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tif &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;data/biodiversity/rls_all.tif&quot;</span>, <span class="dt">package=</span><span class="st">&quot;bbnj&quot;</span>)
r_rls_all &lt;-<span class="st"> </span><span class="kw">raster</span>(tif)
<span class="kw">plot</span>(r_rls_all, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">&quot;rls, all taxa&quot;</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-8-1.png" width="691.2" /></p>
</div>
<div id="rls-by-taxonomic-group" class="section level3">
<h3><code>rls</code>, by taxonomic group</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get all tifs, except first one &quot;nspp_all.tif&quot;</span>
tifs &lt;-<span class="st"> </span><span class="kw">list.files</span>(
  <span class="kw">system.file</span>(<span class="st">&quot;data/biodiversity&quot;</span>, <span class="dt">package=</span><span class="st">&quot;bbnj&quot;</span>), 
  <span class="st">&quot;^rls_.*.tif$&quot;</span>, <span class="dt">full.names =</span> T)[<span class="op">-</span><span class="dv">1</span>]
s_nspp_groups &lt;-<span class="st"> </span><span class="kw">stack</span>(tifs)
<span class="kw">names</span>(s_nspp_groups) &lt;-<span class="st"> </span><span class="kw">str_replace</span>(<span class="kw">names</span>(s_nspp_groups), <span class="st">&quot;rls_&quot;</span>, <span class="st">&quot;&quot;</span>)
<span class="kw">plot</span>(s_nspp_groups, <span class="dt">col =</span> cols)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-9-1.png" width="691.2" /></p>
</div>
</div>
<div id="priotizr-scenarios" class="section level2">
<h2>Priotizr Scenarios</h2>
<div id="p01-10-r_nspp_all_as" class="section level3">
<h3>p01: 10%, <code>r_nspp_all_as</code></h3>
<p>Maximize overall biodiversity, given a budget of 10% of all high seas area.</p>
<ul>
<li><a href="https://prioritizr.net/reference/add_max_utility_objective.html">Add maximum utility objective — add_max_utility_objective • prioritizr</a></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p01 &lt;-<span class="st"> </span><span class="kw">problem</span>(r_pu_areas, r_nspp_all_as) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_max_utility_objective</span>(<span class="dt">budget =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># 10% of total high seas area</span>
<span class="st">  </span><span class="kw">add_gurobi_solver</span>()
p01_sol &lt;-<span class="st"> </span><span class="kw">solve</span>(p01)</code></pre></div>
<pre><code>## Optimize a model with 2 rows, 113402 columns and 215357 nonzeros
## Variable types: 1 continuous, 113401 integer (113401 binary)
## Coefficient statistics:
##   Matrix range     [6e-06, 1e+00]
##   Objective range  [6e-10, 1e+00]
##   Bounds range     [1e+00, 5e+03]
##   RHS range        [1e+01, 1e+01]
## Found heuristic solution: objective -0.0000000
## Presolve removed 0 rows and 79328 columns
## Presolve time: 1.40s
## Presolved: 2 rows, 34074 columns, 68147 nonzeros
## Variable types: 1 continuous, 34073 integer (13583 binary)
## Presolve removed 0 rows and 33031 columns
## Presolved: 2 rows, 1043 columns, 2085 nonzeros
## 
## 
## Root relaxation: objective 9.920199e+02, 3 iterations, 0.05 seconds
## 
##     Nodes    |    Current Node    |     Objective Bounds      |     Work
##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
## 
##      0     0  992.01994    0    1   -0.00000  992.01994      -     -    1s
## H    0     0                     991.9809686  992.01994  0.00%     -    1s
## 
## Explored 1 nodes (3 simplex iterations) in 1.86 seconds
## Thread count was 1 (of 12 available processors)
## 
## Solution count 2: 991.981 -0 
## 
## Optimal solution found (tolerance 1.00e-01)
## Best objective 9.919809686092e+02, best bound 9.920199437738e+02, gap 0.0039%</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(p01_sol, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;grey90&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">main =</span> <span class="st">&quot;Solution&quot;</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/p01-1.png" width="691.2" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># area of solution</span>
<span class="kw">cellStats</span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p01_sol, <span class="st">&quot;sum&quot;</span>)</code></pre></div>
<pre><code>## [1] 9.999548</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate how well features are represented in the solution</span>
<span class="kw">feature_representation</span>(p01, p01_sol)</code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   feature absolute_held relative_held
##   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;
## 1 layer            992.         0.181</code></pre>
</div>
<div id="p02-10-r_nspp_all_as-2-nbrs" class="section level3">
<h3>p02: 10%, <code>r_nspp_all_as</code>, 2 nbrs</h3>
<p>Maximize overall biodiversity, given a budget of 10% of all high seas area, and require 2 rook-style neighbors for all cells in the solution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p02 &lt;-<span class="st"> </span><span class="kw">problem</span>(r_pu_areas, r_nspp_all_as) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_neighbor_constraints</span>(<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st">            </span><span class="co"># require # of rook neighbors</span>
<span class="st">  </span><span class="kw">add_max_utility_objective</span>(<span class="dt">budget =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># budget = % of total high seas area</span>
<span class="st">  </span><span class="kw">add_gurobi_solver</span>()

<span class="co"># solve the problem</span>
p02_sol &lt;-<span class="st"> </span><span class="kw">solve</span>(p02)</code></pre></div>
<pre><code>## Optimize a model with 113403 rows, 113402 columns and 774182 nonzeros
## Variable types: 1 continuous, 113401 integer (113401 binary)
## Coefficient statistics:
##   Matrix range     [6e-06, 2e+00]
##   Objective range  [6e-10, 1e+00]
##   Bounds range     [1e+00, 5e+03]
##   RHS range        [1e+01, 1e+01]
## Found heuristic solution: objective -0.0000000
## Presolve removed 255 rows and 327 columns
## Presolve time: 1.37s
## Presolved: 113148 rows, 113075 columns, 671012 nonzeros
## Variable types: 0 continuous, 113075 integer (113075 binary)
## Presolved: 113148 rows, 113075 columns, 671012 nonzeros
## 
## 
## Root relaxation: objective 9.887442e+02, 1142 iterations, 0.48 seconds
## 
##     Nodes    |    Current Node    |     Objective Bounds      |     Work
##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
## 
##      0     0  988.74424    0  528   -0.00000  988.74424      -     -    2s
## H    0     0                     984.4004167  988.74424  0.44%     -    3s
## 
## Explored 1 nodes (1148 simplex iterations) in 3.15 seconds
## Thread count was 1 (of 12 available processors)
## 
## Solution count 2: 984.4 -0 
## 
## Optimal solution found (tolerance 1.00e-01)
## Best objective 9.844004167298e+02, best bound 9.887442387933e+02, gap 0.4413%</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot solution</span>
<span class="kw">plot</span>(p02_sol, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;grey90&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">main =</span> <span class="st">&quot;Solution&quot;</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/p02-1.png" width="691.2" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># area of solution</span>
<span class="kw">cellStats</span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p02_sol, <span class="st">&quot;sum&quot;</span>)</code></pre></div>
<pre><code>## [1] 9.999843</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate how well features are represented in the solution</span>
tbl_rep &lt;-<span class="st"> </span><span class="kw">feature_representation</span>(p02, p02_sol)
tbl_rep</code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   feature absolute_held relative_held
##   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;
## 1 layer            984.         0.180</code></pre>
<p>The p02 result looks nearly same as p01, only tiny bit lower value in biodiversity held, presumably because of neighbor constraint.</p>
</div>
<div id="p03-10-r_nspp_all_as-3-nbrs" class="section level3">
<h3>p03: 10%, <code>r_nspp_all_as</code>, 3 nbrs</h3>
<p>Maximize overall biodiversity, given a budget of 10% of all high seas area, and require 4 rook-style neighbors for all cells in the solution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p03 &lt;-<span class="st"> </span><span class="kw">problem</span>(r_pu_areas, r_nspp_all_as) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_neighbor_constraints</span>(<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st">            </span><span class="co"># require # of rook neighbors</span>
<span class="st">  </span><span class="kw">add_max_utility_objective</span>(<span class="dt">budget =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># budget = % of total high seas area</span>
<span class="st">  </span><span class="kw">add_gurobi_solver</span>()

<span class="co"># solve the problem</span>
p03_sol &lt;-<span class="st"> </span><span class="kw">solve</span>(p03)</code></pre></div>
<pre><code>## Optimize a model with 113403 rows, 113402 columns and 774182 nonzeros
## Variable types: 1 continuous, 113401 integer (113401 binary)
## Coefficient statistics:
##   Matrix range     [6e-06, 3e+00]
##   Objective range  [6e-10, 1e+00]
##   Bounds range     [1e+00, 5e+03]
##   RHS range        [1e+01, 1e+01]
## Found heuristic solution: objective -0.0000000
## Presolve removed 110521 rows and 111958 columns
## Presolve time: 1.43s
## Presolved: 2882 rows, 1444 columns, 11524 nonzeros
## Found heuristic solution: objective 34.9344798
## Variable types: 0 continuous, 1444 integer (1444 binary)
## 
## Explored 0 nodes (0 simplex iterations) in 1.48 seconds
## Thread count was 1 (of 12 available processors)
## 
## Solution count 1: 34.9345 
## 
## Optimal solution found (tolerance 1.00e-01)
## Best objective 3.493447980634e+01, best bound 3.493447980634e+01, gap 0.0000%</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot solution</span>
<span class="kw">plot</span>(p03_sol, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;grey90&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">main =</span> <span class="st">&quot;Solution&quot;</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/p03-1.png" width="691.2" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># area of solution</span>
<span class="kw">cellStats</span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p03_sol, <span class="st">&quot;sum&quot;</span>)</code></pre></div>
<pre><code>## [1] 2.735375</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate how well features are represented in the solution</span>
tbl_rep &lt;-<span class="st"> </span><span class="kw">feature_representation</span>(p03, p03_sol)
tbl_rep</code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   feature absolute_held relative_held
##   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;
## 1 layer            34.9       0.00637</code></pre>
<p>Whoah, funk! Band around Antarctica with 3 neighbor constraint.</p>
</div>
<div id="p04-10-r_nspp_all_as-4-nbrs" class="section level3">
<h3>p04: 10%, <code>r_nspp_all_as</code>, 4 nbrs</h3>
<p>Maximize overall biodiversity, given a budget of 10% of all high seas area, and require 4 rook-style neighbors for all cells in the solution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p04 &lt;-<span class="st"> </span><span class="kw">problem</span>(r_pu_areas, r_nspp_all_as) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_neighbor_constraints</span>(<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st">            </span><span class="co"># require # of rook neighbors</span>
<span class="st">  </span><span class="kw">add_max_utility_objective</span>(<span class="dt">budget =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># budget = % of total high seas area</span>
<span class="st">  </span><span class="kw">add_gurobi_solver</span>()

<span class="co"># solve the problem</span>
p04_sol &lt;-<span class="st"> </span><span class="kw">solve</span>(p04)</code></pre></div>
<pre><code>## Optimize a model with 113403 rows, 113402 columns and 774182 nonzeros
## Variable types: 1 continuous, 113401 integer (113401 binary)
## Coefficient statistics:
##   Matrix range     [6e-06, 3e+00]
##   Objective range  [6e-10, 1e+00]
##   Bounds range     [1e+00, 5e+03]
##   RHS range        [1e+01, 1e+01]
## Found heuristic solution: objective -0.0000000
## Presolve removed 110521 rows and 111958 columns
## Presolve time: 1.28s
## Presolved: 2882 rows, 1444 columns, 11524 nonzeros
## Found heuristic solution: objective 34.9344798
## Variable types: 0 continuous, 1444 integer (1444 binary)
## 
## Explored 0 nodes (0 simplex iterations) in 1.34 seconds
## Thread count was 1 (of 12 available processors)
## 
## Solution count 1: 34.9345 
## 
## Optimal solution found (tolerance 1.00e-01)
## Best objective 3.493447980634e+01, best bound 3.493447980634e+01, gap 0.0000%</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot solution</span>
<span class="kw">plot</span>(p04_sol, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;grey90&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">main =</span> <span class="st">&quot;Solution&quot;</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/p04-1.png" width="691.2" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># area of solution</span>
<span class="kw">cellStats</span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p04_sol, <span class="st">&quot;sum&quot;</span>)</code></pre></div>
<pre><code>## [1] 2.735375</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate how well features are represented in the solution</span>
tbl_rep &lt;-<span class="st"> </span><span class="kw">feature_representation</span>(p04, p04_sol)
tbl_rep</code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   feature absolute_held relative_held
##   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;
## 1 layer            34.9       0.00637</code></pre>
<p>Whoah, funk! Whole ocean with 4 neighbor constraint.</p>
</div>
<div id="p05-10-r_nspp_all_as-blm0.11" class="section level3">
<h3>p05: 10%, <code>r_nspp_all_as</code>, blm(0.1,1)</h3>
<p>Maximize overall biodiversity, given a budget of 10% of all high seas area, and enforce boundary length modifier.</p>
<ul>
<li><a href="https://prioritizr.net/reference/penalties.html">Conservation problem penalties — penalties • prioritizr</a></li>
<li><a href="https://prioritizr.net/reference/add_boundary_penalties.html">Add boundary penalties — add_boundary_penalties • prioritizr</a></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p05 &lt;-<span class="st"> </span><span class="kw">problem</span>(r_pu_areas, r_nspp_all_as) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_boundary_penalties</span>(<span class="fl">0.1</span>, <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">         </span><span class="co"># boundary penalty (penalty, edge_factor)</span>
<span class="st">  </span><span class="kw">add_max_utility_objective</span>(<span class="dt">budget =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># budget = % of total high seas area</span>
<span class="st">  </span><span class="kw">add_gurobi_solver</span>()

<span class="co"># solve the problem</span>
p05_sol &lt;-<span class="st"> </span><span class="kw">solve</span>(p05)</code></pre></div>
<pre><code>## Optimize a model with 445426 rows, 336114 columns and 1106205 nonzeros
## Variable types: 1 continuous, 336113 integer (336113 binary)
## Coefficient statistics:
##   Matrix range     [6e-06, 1e+00]
##   Objective range  [1e-01, 1e+00]
##   Bounds range     [1e+00, 5e+03]
##   RHS range        [1e+01, 1e+01]
## Found heuristic solution: objective -0.0000000
## Presolve removed 307 rows and 332 columns
## Presolve time: 4.97s
## Presolved: 445119 rows, 335782 columns, 1003482 nonzeros
## Variable types: 0 continuous, 335782 integer (335782 binary)
## Presolve removed 28 rows and 20 columns
## Presolved: 445091 rows, 335762 columns, 1003416 nonzeros
## 
## 
## Root simplex log...
## 
## Iteration    Objective       Primal Inf.    Dual Inf.      Time
##        0    5.2811413e+03   4.691419e+04   0.000000e+00      7s
##    11028    5.1894449e+03   2.104795e+06   0.000000e+00     11s
##    11478    5.1706063e+03   3.270332e+05   0.000000e+00     15s
##    12198    5.1390221e+03   3.433654e+05   0.000000e+00     21s
##    12738    5.1110591e+03   3.410413e+05   0.000000e+00     25s
##    13458    5.0749034e+03   7.197194e+05   0.000000e+00     31s
##    13998    5.0524246e+03   3.199479e+05   0.000000e+00     36s
##    14538    5.0273106e+03   3.775079e+05   0.000000e+00     40s
##    15258    4.9969706e+03   3.188937e+05   0.000000e+00     46s
##    15798    4.9758267e+03   3.642616e+05   0.000000e+00     51s
##    16338    4.9575154e+03   1.055565e+06   0.000000e+00     55s
##    17058    4.9323832e+03   1.063026e+06   0.000000e+00     61s
##    17598    4.9101117e+03   8.071196e+05   0.000000e+00     65s
##    18138    4.8894051e+03   1.116575e+06   0.000000e+00     71s
##    18858    4.8624169e+03   3.092854e+05   0.000000e+00     76s
##    19398    4.8448607e+03   6.377696e+05   0.000000e+00     81s
##    20118    4.8178510e+03   6.237765e+05   0.000000e+00     86s
##    20658    4.8021491e+03   6.741832e+05   0.000000e+00     90s
##    21468    4.7389279e+03   9.623528e+05   0.000000e+00     96s
##    22008    4.7198306e+03   3.057864e+05   0.000000e+00    100s
##    22728    4.6952211e+03   5.803522e+05   0.000000e+00    106s
##    23268    4.6776660e+03   5.458545e+05   0.000000e+00    111s
##    23808    4.6569207e+03   8.924299e+05   0.000000e+00    115s
##    24528    4.6283332e+03   3.131876e+05   0.000000e+00    121s
##    25188    4.5997505e+03   6.666840e+05   0.000000e+00    125s
##    25838    4.5712351e+03   6.747761e+05   0.000000e+00    130s
##    26518    4.5444717e+03   4.904471e+05   0.000000e+00    135s
##    27168    4.5207852e+03   8.211153e+05   0.000000e+00    140s
##    27838    4.4959983e+03   4.625070e+05   0.000000e+00    145s
##    28578    4.4684081e+03   4.808006e+05   0.000000e+00    151s
##    29178    4.4476104e+03   2.835694e+05   0.000000e+00    155s
##    29868    4.4263106e+03   5.662380e+05   0.000000e+00    161s
##    30468    4.4089541e+03   2.279785e+05   0.000000e+00    165s
##    31168    4.3891751e+03   2.815801e+05   0.000000e+00    171s
##    31868    4.3724882e+03   6.125716e+05   0.000000e+00    176s
##    32468    4.1682041e+03   4.466333e+05   0.000000e+00    180s
##    33168    4.0263778e+03   4.675856e+05   0.000000e+00    185s
##    33868    3.9981165e+03   2.928323e+05   0.000000e+00    190s
##    34568    3.9691240e+03   4.798679e+05   0.000000e+00    195s
##    35368    3.9345474e+03   2.515073e+05   0.000000e+00    201s
##    36068    3.9044938e+03   4.932228e+05   0.000000e+00    206s
##    36768    3.8719235e+03   4.321632e+05   0.000000e+00    211s
##    37468    3.8368541e+03   3.866111e+05   0.000000e+00    216s
##    38168    3.8037609e+03   2.461116e+05   0.000000e+00    220s
##    38788    3.7740692e+03   4.027278e+05   0.000000e+00    225s
##    39268    3.7501431e+03   4.150304e+05   0.000000e+00    231s
##    39628    3.7313562e+03   3.695375e+05   0.000000e+00    235s
##    40108    3.7065657e+03   4.779643e+05   0.000000e+00    241s
##    40588    3.6802696e+03   4.356751e+05   0.000000e+00    246s
##    40948    3.6590792e+03   3.969013e+05   0.000000e+00    250s
##    41428    3.6305366e+03   2.377845e+05   0.000000e+00    255s
##    41908    3.5995933e+03   5.246082e+05   0.000000e+00    261s
##    42388    3.5673314e+03   3.532320e+05   0.000000e+00    266s
##    42868    3.5325409e+03   3.104752e+05   0.000000e+00    271s
##    43348    3.4968025e+03   9.190895e+05   0.000000e+00    276s
##    43708    3.4665461e+03   3.823711e+05   0.000000e+00    280s
##    44188    3.4281937e+03   3.711873e+05   0.000000e+00    285s
##    44668    3.3913488e+03   3.128556e+05   0.000000e+00    290s
##    45148    3.3526475e+03   3.082418e+05   0.000000e+00    295s
##    45628    3.3104683e+03   3.411546e+05   0.000000e+00    300s
##    46108    3.2679843e+03   3.353549e+05   0.000000e+00    306s
##    46588    3.2256706e+03   2.882412e+05   0.000000e+00    311s
##    47068    3.1848861e+03   1.631508e+05   0.000000e+00    316s
##    47548    3.1423257e+03   2.971413e+05   0.000000e+00    321s
##    48048    3.0978128e+03   3.075269e+05   0.000000e+00    326s
##    48468    3.0602258e+03   3.298113e+05   0.000000e+00    330s
##    49028    3.0103447e+03   4.984586e+05   0.000000e+00    336s
##    49448    2.9793354e+03   2.822919e+05   0.000000e+00    340s
##    50008    2.9380407e+03   2.681382e+05   0.000000e+00    346s
##    50428    2.9079643e+03   3.134439e+05   0.000000e+00    350s
##    50988    2.8713294e+03   2.731501e+05   0.000000e+00    356s
##    51408    2.8429208e+03   2.941560e+05   0.000000e+00    360s
##    51968    2.8055003e+03   3.022694e+05   0.000000e+00    366s
##    52528    2.7652779e+03   3.052698e+05   0.000000e+00    371s
##    52948    2.7330421e+03   2.839236e+05   0.000000e+00    375s
##    53508    2.6942371e+03   2.971619e+05   0.000000e+00    381s
##    53928    2.6678807e+03   2.636244e+05   0.000000e+00    385s
##    54488    2.6318680e+03   7.601471e+05   0.000000e+00    391s
##    55048    2.5937236e+03   2.947659e+05   0.000000e+00    396s
##    55468    2.5627731e+03   2.813071e+05   0.000000e+00    400s
##    56028    2.5266517e+03   2.397233e+05   0.000000e+00    406s
##    56588    2.4883922e+03   2.455134e+05   0.000000e+00    411s
##    57148    2.4520989e+03   1.943404e+05   0.000000e+00    416s
##    57568    2.4256213e+03   2.087627e+05   0.000000e+00    420s
##    58128    2.3932057e+03   2.453281e+05   0.000000e+00    426s
##    58688    2.3641173e+03   4.290203e+05   0.000000e+00    431s
##    59248    2.3383492e+03   1.966977e+05   0.000000e+00    436s
##    59668    2.3197058e+03   2.241642e+05   0.000000e+00    440s
##    60258    2.2964294e+03   2.143942e+05   0.000000e+00    446s
##    60738    2.2778472e+03   2.282837e+05   0.000000e+00    450s
##    61378    2.2566453e+03   2.116070e+05   0.000000e+00    456s
##    61818    2.2408315e+03   1.865791e+05   0.000000e+00    461s
##    62238    2.2269180e+03   1.847612e+05   0.000000e+00    466s
##    62658    2.2139203e+03   2.078041e+05   0.000000e+00    471s
##    63078    2.2008398e+03   2.224161e+05   0.000000e+00    476s
##    63498    2.1873134e+03   1.747439e+05   0.000000e+00    480s
##    64058    2.1693888e+03   1.946606e+05   0.000000e+00    486s
##    64478    2.1568327e+03   1.904994e+05   0.000000e+00    491s
##    64898    2.1457098e+03   1.745520e+05   0.000000e+00    496s
##    65318    2.1336689e+03   1.671125e+05   0.000000e+00    500s
##    65738    2.1211505e+03   1.987616e+05   0.000000e+00    505s
##    66158    2.1108970e+03   1.758484e+05   0.000000e+00    510s
##    66578    2.1002240e+03   1.534623e+05   0.000000e+00    515s
##    67138    2.0863790e+03   1.886194e+05   0.000000e+00    521s
##    67558    2.0764259e+03   1.744549e+05   0.000000e+00    525s
##    68168    2.0618245e+03   1.679315e+05   0.000000e+00    531s
##    68648    2.0504923e+03   1.441044e+05   0.000000e+00    536s
##    69128    2.0398003e+03   1.633197e+05   0.000000e+00    541s
##    69608    2.0294114e+03   1.651967e+05   0.000000e+00    547s
##    69928    2.0225629e+03   1.601852e+05   0.000000e+00    550s
##    70568    2.0096443e+03   1.519617e+05   0.000000e+00    556s
##    71048    2.0005333e+03   1.722287e+05   0.000000e+00    561s
##    71528    1.9913806e+03   1.619217e+05   0.000000e+00    566s
##    72008    1.9830638e+03   1.458212e+05   0.000000e+00    570s
##    72648    1.9726197e+03   1.301232e+05   0.000000e+00    576s
##    73128    1.9646718e+03   9.233934e+04   0.000000e+00    581s
##    73608    1.9566912e+03   1.380958e+05   0.000000e+00    585s
##    74088    1.9492783e+03   1.207502e+05   0.000000e+00    590s
##    74728    1.9401251e+03   1.422476e+05   0.000000e+00    596s
##    75228    1.9331650e+03   1.160121e+05   0.000000e+00    600s
##    75768    1.9264887e+03   1.246621e+05   0.000000e+00    605s
##    76488    1.9176059e+03   1.230907e+05   0.000000e+00    612s
##    77028    1.9104976e+03   1.346462e+05   0.000000e+00    616s
##    77568    1.9043002e+03   1.197919e+05   0.000000e+00    621s
##    78108    1.8979618e+03   1.155975e+05   0.000000e+00    626s
##    78648    1.8921210e+03   8.673842e+04   0.000000e+00    631s
##    79188    1.8860033e+03   1.069259e+05   0.000000e+00    635s
##    79728    1.8800597e+03   9.740205e+04   0.000000e+00    640s
##    80448    1.8722698e+03   1.021646e+05   0.000000e+00    646s
##    80938    1.8673578e+03   9.362515e+04   0.000000e+00    650s
##    81538    1.8614764e+03   9.640479e+04   0.000000e+00    655s
##    82138    1.8561079e+03   9.143632e+04   0.000000e+00    660s
##    82738    1.8510024e+03   8.579200e+04   0.000000e+00    666s
##    83338    1.8461628e+03   8.172859e+04   0.000000e+00    671s
##    83838    1.8426295e+03   7.973351e+04   0.000000e+00    675s
##    84438    1.8385203e+03   7.736091e+04   0.000000e+00    680s
##    85038    1.8345207e+03   7.347830e+04   0.000000e+00    686s
##    85588    1.8310336e+03   7.343738e+04   0.000000e+00    690s
##    86138    1.8279262e+03   7.451281e+04   0.000000e+00    695s
##    86798    1.8240291e+03   6.851589e+04   0.000000e+00    701s
##    87348    1.8208463e+03   6.301381e+04   0.000000e+00    705s
##    87898    1.8178166e+03   6.092209e+04   0.000000e+00    710s
##    88568    1.8142915e+03   5.692452e+04   0.000000e+00    716s
##    89168    1.8113666e+03   6.047615e+04   0.000000e+00    721s
##    89648    1.8092736e+03   5.310550e+04   0.000000e+00    725s
##    90248    1.8068730e+03   4.954450e+04   0.000000e+00    731s
##    90728    1.8051323e+03   1.035455e+05   0.000000e+00    736s
##    91208    1.8035763e+03   7.103697e+04   0.000000e+00    740s
##    91698    1.8021120e+03   4.781339e+04   0.000000e+00    745s
##    92348    1.8003497e+03   4.108900e+04   0.000000e+00    751s
##    92868    1.7992224e+03   3.927822e+04   0.000000e+00    756s
##    93388    1.7982696e+03   3.547430e+04   0.000000e+00    761s
##    93998    1.7900491e+03   3.314291e+04   0.000000e+00    766s
##    95058    1.7462010e+03   3.226019e+04   0.000000e+00    771s
##    96408    1.6922856e+03   3.117472e+04   0.000000e+00    776s
##    97768    1.6386290e+03   3.009799e+04   0.000000e+00    781s
##    99148    1.5853320e+03   3.009481e+04   0.000000e+00    786s
##   100148    1.5502182e+03   2.662877e+04   0.000000e+00    790s
##   101878    1.4865791e+03   2.429946e+04   0.000000e+00    796s
##   103208    1.4584444e+03   2.581316e+04   0.000000e+00    800s
##   105248    1.4191350e+03   2.184020e+04   0.000000e+00    806s
##   106888    1.3796038e+03   2.177587e+04   0.000000e+00    811s
##   108178    1.3553955e+03   2.110584e+04   0.000000e+00    816s
##   110568    1.2376229e+03   2.303951e+04   0.000000e+00    821s
##   111218    1.2355462e+03   2.141651e+04   0.000000e+00    826s
##   112658    1.2150827e+03   2.001265e+04   0.000000e+00    831s
##   114568    1.1364178e+03   2.419566e+04   0.000000e+00    836s
##   116948    1.0180111e+03   1.628379e+04   0.000000e+00    841s
##   118528    9.6060848e+02   1.355115e+04   0.000000e+00    846s
##   119738    9.3319166e+02   1.312201e+04   0.000000e+00    851s
##   120778    9.2092110e+02   1.174394e+04   0.000000e+00    856s
##   122138    8.8257770e+02   8.712523e+03   0.000000e+00    861s
##   140382    7.8955799e+02   3.390244e+03   0.000000e+00    866s
##   141072    7.8928776e+02   2.033666e+03   0.000000e+00    870s
##   141742    7.8914157e+02   1.947767e+03   0.000000e+00    875s
##   142412    7.8899908e+02   3.796640e+02   0.000000e+00    880s
##   143222    7.8885285e+02   2.508573e+01   0.000000e+00    886s
##   143782    7.8881833e+02   1.056603e+01   0.000000e+00    891s
##   145307    8.9321828e+02   0.000000e+00   0.000000e+00    894s
##   145307    8.9321828e+02   0.000000e+00   0.000000e+00    894s
## 
## Root relaxation: objective 8.932183e+02, 145307 iterations, 888.88 seconds
## 
##     Nodes    |    Current Node    |     Objective Bounds      |     Work
##  Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time
## 
##      0     0  893.21828    0   32   -0.00000  893.21828      -     -  895s
## H    0     0                     892.3181825  893.21828  0.10%     -  895s
## 
## Explored 1 nodes (145307 simplex iterations) in 895.88 seconds
## Thread count was 1 (of 12 available processors)
## 
## Solution count 2: 892.318 -0 
## 
## Optimal solution found (tolerance 1.00e-01)
## Best objective 8.923181824555e+02, best bound 8.932182765739e+02, gap 0.1009%</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot solution</span>
<span class="kw">plot</span>(p05_sol, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;grey90&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">main =</span> <span class="st">&quot;Solution&quot;</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/p05-1.png" width="691.2" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># area of solution</span>
<span class="kw">cellStats</span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p05_sol, <span class="st">&quot;sum&quot;</span>)</code></pre></div>
<pre><code>## [1] 9.999538</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate how well features are represented in the solution</span>
tbl_rep &lt;-<span class="st"> </span><span class="kw">feature_representation</span>(p05, p05_sol)
tbl_rep</code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   feature absolute_held relative_held
##   &lt;chr&gt;           &lt;dbl&gt;         &lt;dbl&gt;
## 1 layer            957.         0.174</code></pre>
<p>Whoah, funk! Whole ocean with 4 neighbor constraint.</p>
</div>
</div>
<div id="todo-near-term" class="section level2">
<h2>TODO: near-term</h2>
<ol style="list-style-type: decimal">
<li><a href="https://prioritizr.net/reference/add_locked_out_constraints.html">add_locked_out_constraints()</a> for mining leased areas</li>
<li>Explore <a href="https://prioritizr.net/reference/portfolios.html">Solution portfolios</a> solves for stack of alternative raster solutions.</li>
<li>Explore <a href="https://prioritizr.net/reference/add_loglinear_targets.html">add_loglinear_targets()</a></li>
</ol>
<div id="refs" class="references">
<div id="ref-butchartImprovementsRedList2007">
<p>Butchart, Stuart H. M., H. Resit Akçakaya, Janice Chanson, Jonathan E. M. Baillie, Ben Collen, Suhel Quader, Will R. Turner, Rajan Amin, Simon N. Stuart, and Craig Hilton-Taylor. 2007. “Improvements to the Red List Index.” <em>PLOS ONE</em> 2 (1): e140. doi:<a href="https://doi.org/10.1371/journal.pone.0000140">10.1371/journal.pone.0000140</a>.</p>
</div>
<div id="ref-juslenApplicationRedList2016">
<p>Juslén, Aino, Juha Pykälä, Saija Kuusela, Lauri Kaila, Jaakko Kullberg, Jaakko Mattila, Jyrki Muona, Sanna Saari, and Pedro Cardoso. 2016. “Application of the Red List Index as an Indicator of Habitat Change.” <em>Biodivers Conserv</em> 25 (3): 569–85. doi:<a href="https://doi.org/10.1007/s10531-016-1075-0">10.1007/s10531-016-1075-0</a>.</p>
</div>
<div id="ref-kaschnerAquaMapsPredictedRange2016">
<p>Kaschner, K., K. Kesner-Reyes, C. Garilao, J. Rius-Barile, T. Rees, and R. Froese. 2016. “AquaMaps: Predicted Range Maps for Aquatic Species.” World Wide Web Electronic Publication.</p>
</div>
<div id="ref-kleinShortfallsGlobalProtected2015">
<p>Klein, Carissa J., Christopher J. Brown, Benjamin S. Halpern, Daniel B. Segan, Jennifer McGowan, Maria Beger, and James E. M. Watson. 2015. “Shortfalls in the Global Protected Area Network at Representing Marine Biodiversity.” <em>Scientific Reports</em> 5 (December): 17539. doi:<a href="https://doi.org/10.1038/srep17539">10.1038/srep17539</a>.</p>
</div>
<div id="ref-oharaAligningMarineSpecies2017">
<p>O’Hara, Casey C., Jamie C. Afflerbach, Courtney Scarborough, Kristin Kaschner, and Benjamin S. Halpern. 2017. “Aligning Marine Species Range Data to Better Serve Science and Conservation.” <em>PLOS ONE</em> 12 (5): e0175739. doi:<a href="https://doi.org/10.1371/journal.pone.0175739">10.1371/journal.pone.0175739</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul>
      <li><a href="#setup">Setup</a></li>
      <li><a href="#planning-units">Planning Units</a><ul>
      <li><a href="#pu-cost-as-area">PU Cost as Area</a></li>
      </ul></li>
      <li><a href="#conservation-targets">Conservation Targets</a><ul>
      <li><a href="#biodiversity">Biodiversity</a></li>
      <li><a href="#nspp-all-taxa"><code>nspp</code>, all taxa</a></li>
      <li><a href="#nspp-all-taxa-area-scaled"><code>nspp</code>, all taxa, area scaled</a></li>
      <li><a href="#nspp-by-taxonomic-group"><code>nspp</code>, by taxonomic group</a></li>
      <li><a href="#rls-all-taxa"><code>rls</code>, all taxa</a></li>
      <li><a href="#rls-by-taxonomic-group"><code>rls</code>, by taxonomic group</a></li>
      </ul></li>
      <li><a href="#priotizr-scenarios">Priotizr Scenarios</a><ul>
      <li><a href="#p01-10-r_nspp_all_as">p01: 10%, <code>r_nspp_all_as</code></a></li>
      <li><a href="#p02-10-r_nspp_all_as-2-nbrs">p02: 10%, <code>r_nspp_all_as</code>, 2 nbrs</a></li>
      <li><a href="#p03-10-r_nspp_all_as-3-nbrs">p03: 10%, <code>r_nspp_all_as</code>, 3 nbrs</a></li>
      <li><a href="#p04-10-r_nspp_all_as-4-nbrs">p04: 10%, <code>r_nspp_all_as</code>, 4 nbrs</a></li>
      <li><a href="#p05-10-r_nspp_all_as-blm0.11">p05: 10%, <code>r_nspp_all_as</code>, blm(0.1,1)</a></li>
      </ul></li>
      <li><a href="#todo-near-term">TODO: near-term</a></li>
      </ul>
    </div>
      </div>

</div>


      <footer>
      <div class="copyright">
  <p>Developed by Ben Best.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>
