<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Explore prioritizr • bbnj</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Explore prioritizr">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bbnj</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/prep_climate_ubc.html">Prep climate UBC data</a>
    </li>
    <li>
      <a href="../articles/prioritizr_explore.html">Explore prioritizr</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ecoquants/bbnj">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Explore prioritizr</h1>
                        <h4 class="author">Ben Best</h4>
            
            <h4 class="date">2019-03-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ecoquants/bbnj/blob/master/vignettes/prioritizr_explore.Rmd"><code>vignettes/prioritizr_explore.Rmd</code></a></small>
      <div class="hidden name"><code>prioritizr_explore.Rmd</code></div>

    </div>

    
    
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">suppressPackageStartupMessages</a></span>({
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse)
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(here)
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(glue)
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(raster)
  select =<span class="st"> </span>dplyr<span class="op">::</span>select
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(sf)
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(leaflet)
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(RColorBrewer)
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rasterVis)
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(prioritizr) <span class="co"># install.packages("prioritizr")</span>
  
  <span class="co">#library(bbnj) </span>
  <span class="co"># devtools::install_local(here::here(), force=T) </span>
  devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/load_all">load_all</a></span>()
})
<span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/basename">basename</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/getwd">getwd</a></span>())<span class="op">!=</span><span class="st">"vignettes"</span>) <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/getwd">setwd</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/here/topics/here">here</a></span>(<span class="st">"vignettes"</span>))

<span class="co"># set rainbow color palette</span>
pal &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/colorRamp">colorRampPalette</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/RColorBrewer/topics/ColorBrewer">brewer.pal</a></span>(<span class="dv">11</span>, <span class="st">"Spectral"</span>))
cols &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rev">rev</a></span>(<span class="kw">pal</span>(<span class="dv">255</span>))</code></pre></div>
</div>
<div id="bbnj-data-sets" class="section level2">
<h2 class="hasAnchor">
<a href="#bbnj-data-sets" class="anchor"></a>BBNJ data sets</h2>
<p>The core datasets for developing BBNJ scenarios have been made available within the R package using the <a href="https://github.com/ecoquants/bbnj/blob/master/data-raw/create_data.R">data-raw/create_data.R</a> script, which also clips input datasets to the high seas, for lazy loading within R. For programs external to R, usable formats (*.tif, *.shp) have been placed into the <a href="https://github.com/ecoquants/bbnj/blob/master/data-raw/create_data.R">data-raw/</a> folder online, which you can access by downloading the latest <a href="https://github.com/ecoquants/bbnj/archive/master.zip">bbnj master.zip</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># view list of all datasets in bbnj R package</span>
<span class="co">#data(package="bbnj")</span>

<span class="co"># get detailed help on any dataset</span>
<span class="co"># ?r_pu_id</span>

<span class="co"># use lazily loaded dataset, not showing in environment</span>
r_pu_id</code></pre></div>
<pre><code>## class       : RasterLayer 
## dimensions  : 360, 720, 259200  (nrow, ncol, ncell)
## resolution  : 0.5, 0.5  (x, y)
## extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 
## data source : /Users/bbest/Gdrive Ecoquants/projects/bbnj/data/derived/boundary/high_seas_cellid_0.5dd.tif 
## names       : high_seas_cellid_0.5dd 
## values      : 1, 251323  (min, max)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># explicitly attach to environment</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"r_pu_id"</span>)</code></pre></div>
</div>
<div id="planning-units" class="section level2">
<h2 class="hasAnchor">
<a href="#planning-units" class="anchor"></a>Planning Units</h2>
<p>Using half-degree global raster (resolution of AquaMaps, GFW, …).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># show planning unit id raster</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(r_pu_id, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">"pu_id"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-3-1.png" width="691.2"></p>
<div id="pu-cost-as-area" class="section level3">
<h3 class="hasAnchor">
<a href="#pu-cost-as-area" class="anchor"></a>PU Cost as Area</h3>
<p>Get area for planning units (<span class="math inline">\(km^2\)</span>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r_pu_area &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/area">area</a></span>(r_pu_id) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># in km2</span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/mask">mask</a></span>(r_pu_id)

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(r_pu_area, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">"pu_area (km2)"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-4-1.png" width="691.2"></p>
<p>Rescale area for being able to set planning unit budgets to percentages of the global high seas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/cellStats">cellStats</a></span>(r_pu_area, <span class="st">"sum"</span>)
r_pu_areas &lt;-<span class="st"> </span>r_pu_area <span class="op">/</span><span class="st"> </span>A
<span class="co">#cellStats(r_pu_areas, "sum") # 1</span>

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(r_pu_areas, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">"pu_areas (sums to 1)"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-5-1.png" width="691.2"></p>
</div>
</div>
<div id="conservation-targets" class="section level2">
<h2 class="hasAnchor">
<a href="#conservation-targets" class="anchor"></a>Conservation Targets</h2>
<div id="biodiversity" class="section level3">
<h3 class="hasAnchor">
<a href="#biodiversity" class="anchor"></a>Biodiversity</h3>
<p>All the species distribution data was generously provided as comma-seperated value (csv) files in a zip package <code>aquamaps_ver0816c.zip</code> by Kristin Kaschner and Cristina Garilao to Ben Best <a href="mailto:ben@ecoquants.com">ben@ecoquants.com</a> on Jun 21, 2018 from the extensive work available at <a href="http://AquaMaps.org" class="uri">http://AquaMaps.org</a> to be fully cited <span class="citation">(K. Kaschner et al. 2016)</span> whenever used. For details on generating indicators, see <a href="https://marinebon.github.io/gmbi/articles/calc.html">Calculate Indicators • gmbi</a>:</p>
<p>Note that a probability ≥ 0.5 was used to convert AquaMaps relative environmental suitability (RES) from continuous [0 - 1] to binary [0,1] <span class="citation">(Klein et al. 2015; O’Hara et al. 2017)</span> for generating these two indicators:</p>
<ul>
<li><p><code>nspp</code>: number of species, ie species richness</p></li>
<li><p><code>rls</code>: Red List Sum (RLS)</p></li>
</ul>
<p>The Red List Sum (RLS) is the numerator from the Red List Index (RLI) (<span class="citation">(Butchart et al. 2007; Juslén et al. 2016)</span>:</p>
<p><span class="math display">\[RLS = \sum_{i=1}^{n_{spp}} w_i\]</span></p>
<p>We will use only the numerator, the Red List Sum (RLS), of the Red List Index (RLI) to quantify the “endangeredness” of a cell without dilution from being in a species-rich place as the RLI does when averaging the extinction risk for all assessed species. For more details see <a href="https://marinebon.github.io/gmbi/articles/calc.html#calculate-extinction-risk">Calculate extinction risk - Calculate Indicators • gmbi</a>.</p>
<p>These indicators were calculated for all species as well as taxonomic groups defined in <a href="https://marinebon.github.io/gmbi/articles/calc.html#assign-taxonomic-groups">Assign taxonomic groups - Calculate Indicators • gmbi</a>.</p>
<p>With rasters from R package <a href="https://github.com/marinebon/gmbi">marinebon/gmbi</a>, mask rasters to high seas planning units and save into this R package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/names">names</a></span>(s_bio_gmbi)</code></pre></div>
<pre><code>##  [1] "nspp_all"                   "nspp_bivalves"             
##  [3] "nspp_chitons"               "nspp_coastal.fishes"       
##  [5] "nspp_corals"                "nspp_crustaceans"          
##  [7] "nspp_echinoderms"           "nspp_euphausiids"          
##  [9] "nspp_gastropods"            "nspp_hydrozoans"           
## [11] "nspp_mangroves"             "nspp_na"                   
## [13] "nspp_non.squid.cephalopods" "nspp_pinnipeds"            
## [15] "nspp_reptiles"              "nspp_sea.spiders"          
## [17] "nspp_seagrasses"            "nspp_sharks"               
## [19] "nspp_sponges"               "nspp_tunas.n.billfishes"   
## [21] "nspp_tunicates"             "nspp_worms"                
## [23] "rls_all"                    "rls_bivalves"              
## [25] "rls_coastal.fishes"         "rls_corals"                
## [27] "rls_crustaceans"            "rls_echinoderms"           
## [29] "rls_gastropods"             "rls_na"                    
## [31] "rls_non.squid.cephalopods"  "rls_pinnipeds"             
## [33] "rls_reptiles"               "rls_sharks"                
## [35] "rls_tunas.n.billfishes"</code></pre>
<div id="nspp-all-taxa" class="section level4">
<h4 class="hasAnchor">
<a href="#nspp-all-taxa" class="anchor"></a><code>nspp</code>, all taxa</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r_nspp_all &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(s_bio_gmbi, <span class="st">"nspp_all"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(r_nspp_all, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">"nspp, all taxa"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-7-1.png" width="691.2"></p>
</div>
<div id="nspp-all-taxa-area-scaled" class="section level4">
<h4 class="hasAnchor">
<a href="#nspp-all-taxa-area-scaled" class="anchor"></a><code>nspp</code>, all taxa, area scaled</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r_nspp_all_as &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rescale_raster.html">rescale_raster</a></span>(r_nspp_all, <span class="dt">multiply_area=</span>T) <span class="co"># "bio_nspp"</span>

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(r_nspp_all_as, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">"nspp, all taxa, area scaled"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-8-1.png" width="691.2"></p>
</div>
<div id="nspp-by-taxonomic-group" class="section level4">
<h4 class="hasAnchor">
<a href="#nspp-by-taxonomic-group" class="anchor"></a><code>nspp</code>, by taxonomic group</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grps_nspp &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/names">names</a></span>(s_bio_gmbi) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">str_subset</span>(<span class="st">"^nspp_"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">str_subset</span>(<span class="st">"_all$"</span>, <span class="dt">negate=</span>T)
s_bio_nspp_grps &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/subset">subset</a></span>(s_bio_gmbi, grps_nspp)

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/names">names</a></span>(s_bio_nspp_grps) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/names">names</a></span>(s_bio_nspp_grps) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">str_replace</span>(<span class="st">"nspp_"</span>, <span class="st">""</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(s_bio_nspp_grps, <span class="dt">col =</span> cols)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-9-1.png" width="691.2"></p>
</div>
<div id="rls-all-taxa" class="section level4">
<h4 class="hasAnchor">
<a href="#rls-all-taxa" class="anchor"></a><code>rls</code>, all taxa</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r_rls_all &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(s_bio_gmbi, <span class="st">"rls_all"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(r_rls_all, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">"rls, all taxa"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-10-1.png" width="691.2"></p>
</div>
<div id="rls-all-taxa-area-scaled" class="section level4">
<h4 class="hasAnchor">
<a href="#rls-all-taxa-area-scaled" class="anchor"></a><code>rls</code>, all taxa, area scaled</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r_rls_all_as &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rescale_raster.html">rescale_raster</a></span>(r_rls_all, <span class="dt">multiply_area=</span>T)

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(r_rls_all_as, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">"rls, all taxa, area scaled"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-11-1.png" width="691.2"></p>
</div>
<div id="rls-by-taxonomic-group" class="section level4">
<h4 class="hasAnchor">
<a href="#rls-by-taxonomic-group" class="anchor"></a><code>rls</code>, by taxonomic group</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grps_rls &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/names">names</a></span>(s_bio_gmbi) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">str_subset</span>(<span class="st">"^rls_"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">str_subset</span>(<span class="st">"_all$"</span>, <span class="dt">negate=</span>T)
s_bio_rls_grps &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/subset">subset</a></span>(s_bio_gmbi, grps_rls)

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/names">names</a></span>(s_bio_rls_grps) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/names">names</a></span>(s_bio_rls_grps) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">str_replace</span>(<span class="st">"rls_"</span>, <span class="st">""</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(s_bio_rls_grps, <span class="dt">col =</span> cols)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-12-1.png" width="691.2"></p>
</div>
</div>
<div id="physiographic-seamounts" class="section level3">
<h3 class="hasAnchor">
<a href="#physiographic-seamounts" class="anchor"></a>Physiographic: Seamounts</h3>
<p>Count of seamounts (Kim &amp; Wessel, 2011) in half-degree cells:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(r_phys_seamounts, <span class="dt">col =</span> cols, <span class="dt">main=</span><span class="st">"r_phys_seamounts"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-13-1.png" width="691.2"></p>
</div>
<div id="physiographic-benthic-seascapes" class="section level3">
<h3 class="hasAnchor">
<a href="#physiographic-benthic-seascapes" class="anchor"></a>Physiographic: Benthic Seascapes</h3>
<p>Area (km2) of 1 thru 11 classes of benthic seascapes (Harris &amp; Whiteway, 2009):</p>
<ol style="list-style-type: decimal">
<li>Upper Bathyal, shallow shelf, low DO, very high PP. thick sediment very warm</li>
<li>Lower Bathyal, deep shelf (submerged), marginal plateaus, very high DO, high PP, thick sediment, warm</li>
<li>Lower Bathyal, other ridges and plateaus, marginal plateaus, marginal seas with hilly bottom, steep, very low DO</li>
<li>Lower Bathyal, continental slope see high PP, very thick sediment, warm</li>
<li>Lower Bathyal, island arcs, steep, high DO</li>
<li>Lower Bathyal (Abyssal-Hadal), deep water trenches, island arcs, trenches controlled by fracture zones, volcanic ridges and plateaus, very steep</li>
<li>Abyssal, volcanic ridges and highs, central rift zone, ridge flanks, microcontinents, cold</li>
<li>Abyssal, flat sedimented plains of marginal seas, central rift zone, ridge flanks, marginal seas with hilly bottoms, flat, low DO, thin sediment</li>
<li>Abyssal (Hadal), trenches controlled by fracture zones, deep water trenches, large arched uplifted structures, low PP thin sediment, cold</li>
<li>Abyssal, plains with slightly undulating seafloor, flat abyssal plains, continental rise, very flat, high DO, low PP, very cold</li>
<li>Abyssal, hilly plains, large (arched) uplifted structures, flat abyssal plains, flat, very low PP, very thin sediment</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(s_phys_scapes, <span class="dt">col =</span> cols)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-14-1.png" width="691.2"></p>
</div>
<div id="fisheries-global-fishing-watch" class="section level3">
<h3 class="hasAnchor">
<a href="#fisheries-global-fishing-watch" class="anchor"></a>Fisheries: Global Fishing Watch</h3>
<p>Raster stack from Global Fishing Watch analysis of high seas (Sala et al, 2018) for half-degree raster of high seas (year of analysis: 2016).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/names">names</a></span>(s_fish_gfw)</code></pre></div>
<pre><code>## [1] "fishing_KWH"                       
## [2] "mean_costs"                        
## [3] "revenue"                           
## [4] "mean_scaled_profits"               
## [5] "mean_scaled_profits_with_subsidies"
## [6] "scaled_profits_low_labor_cost"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(s_fish_gfw, <span class="dt">col =</span> cols)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-15-1.png" width="691.2"></p>
<div id="gap-filling-fisheries-layer" class="section level4">
<h4 class="hasAnchor">
<a href="#gap-filling-fisheries-layer" class="anchor"></a>Gap-Filling Fisheries Layer</h4>
<p>Assuming places fished have the least profit, gap fill with minimum value:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r_fish_gfw.profit           &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(s_fish_gfw, <span class="st">"mean_scaled_profits"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/gap_fill_raster.html">gap_fill_raster</a></span>()
r_fish_gfw.profit.subsidies &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(s_fish_gfw, <span class="st">"mean_scaled_profits_with_subsidies"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/gap_fill_raster.html">gap_fill_raster</a></span>()

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(r_fish_gfw.profit.subsidies, <span class="dt">col=</span>cols, <span class="dt">main=</span><span class="st">"r_gfw_profit.subsidies"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-16-1.png" width="691.2"></p>
</div>
<div id="inverting-fisheries-for-conservation-target" class="section level4">
<h4 class="hasAnchor">
<a href="#inverting-fisheries-for-conservation-target" class="anchor"></a>Inverting Fisheries for Conservation Target</h4>
<p>Fisheries could be included into the optimization in at least a couple ways:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Fisheries as Planning Unit Cost (Minimize)</strong>. By minimizing the planning unit cost, conservation targets are maximized.</p></li>
<li><p><strong>Fisheries as Conservation Target (Maximize Inverse)</strong>. To reduce friction with fishing industry the maximum profit areas are to be minimized. To achieve this on the conservation target side of the optimization the inverse of the original profit layers is to be used, which can take the form:</p></li>
</ol>
<p><span class="math display">\[v_{cell} = 1 - \frac{v_{cell}}{\max(v) - \min(v)}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r_fish_gfw.profit.subsidies_inv &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rescale_raster.html">rescale_raster</a></span>(r_fish_gfw.profit.subsidies, <span class="dt">inverse=</span>T) <span class="co">#, log=T)</span>

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/hist">hist</a></span>(r_fish_gfw.profit.subsidies, <span class="dt">main=</span><span class="st">"r_gfw_profit.subsidies"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-17-1.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/hist">hist</a></span>(r_fish_gfw.profit.subsidies_inv, <span class="dt">main=</span><span class="st">"r_gfw_profit.subsidies_inv"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-17-2.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(r_fish_gfw.profit.subsidies_inv, <span class="dt">col=</span>cols, <span class="dt">main=</span><span class="st">"r_gfw_profit.subsidies_inv"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-17-3.png" width="691.2"></p>
</div>
</div>
<div id="fisheries-u-of-british-columbia" class="section level3">
<h3 class="hasAnchor">
<a href="#fisheries-u-of-british-columbia" class="anchor"></a>Fisheries: U of British Columbia</h3>
<p>Raster stack from UBC (Cheung, Lam et al; in draft) of maximum catch potential (MCP; landings in metric tons) of more than 1,000 fish and invertebrates species for  (average 1995 to 2014) and  (average 2041 to 2060 under ‘business as usual’ climate change scenario GFDL 8.5).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(s_fish_ubc, <span class="dt">col =</span> cols)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-18-1.png" width="691.2"></p>
<div id="rescale-and-invert" class="section level4">
<h4 class="hasAnchor">
<a href="#rescale-and-invert" class="anchor"></a>Rescale and Invert</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s_fish_ubc_inv  &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rescale_stack.html">rescale_stack</a></span>(s_fish_ubc, <span class="dt">inverse=</span>T)
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(s_fish_ubc_inv, <span class="dt">col =</span> cols)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-19-1.png" width="691.2"></p>
</div>
</div>
</div>
<div id="priorization-scenarios" class="section level2">
<h2 class="hasAnchor">
<a href="#priorization-scenarios" class="anchor"></a>Priorization Scenarios</h2>
<div id="p01-biodiversity-centric-10-max-utility" class="section level3">
<h3 class="hasAnchor">
<a href="#p01-biodiversity-centric-10-max-utility" class="anchor"></a>p01: Biodiversity Centric, 10%, max utility</h3>
<p>Maximize diversity of species and habitats, given a budget of 10% of the high seas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p01_features &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/stack">stack</a></span>(
  r_nspp_all_as,
  r_rls_all_as,
  <span class="kw"><a href="../reference/rescale_raster.html">rescale_raster</a></span>(r_phys_seamounts),
  <span class="kw"><a href="../reference/rescale_raster.html">rescale_raster</a></span>(r_phys_vents),
  <span class="kw"><a href="../reference/rescale_stack.html">rescale_stack</a></span>(s_phys_scapes))
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/names">names</a></span>(p01_features) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(
  <span class="st">"bio_nspp"</span>, 
  <span class="st">"bio_rls"</span>,
  <span class="st">"phys_seamounts"</span>,
  <span class="st">"phys_vents"</span>,
  <span class="kw"><a href="https://www.rdocumentation.org/packages/glue/topics/glue">glue</a></span>(<span class="st">"phys_scape{1:11}"</span>))

<span class="co"># hist(r_nspp_all_as); hist(r_rls_all_as); hist(rescale_raster(r_phys_seamounts))</span>

p01_sum &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/stackApply">stackApply</a></span>(p01_features, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/nlayers">nlayers</a></span>(p01_features)), sum) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/mask">mask</a></span>(r_pu_id)
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(p01_sum, <span class="dt">col=</span>cols)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-20-1.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p01 &lt;-<span class="st"> </span><span class="kw"><a href="https://prioritizr.net/reference/problem.html">problem</a></span>(r_pu_areas, p01_features) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_max_utility_objective.html">add_max_utility_objective</a></span>(<span class="dt">budget =</span> <span class="fl">0.1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># 10% of total high seas area</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_gurobi_solver.html">add_gurobi_solver</a></span>()

p01_sol &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solve_log.html">solve_log</a></span>(p01, <span class="dt">redo=</span>F)

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(p01_sol, <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"grey90"</span>, <span class="st">"darkgreen"</span>), <span class="dt">main =</span> <span class="st">"p01 solution"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-20-2.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># area of solution</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/cellStats">cellStats</a></span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p01_sol, <span class="st">"sum"</span>)</code></pre></div>
<pre><code>## [1] 0.0999999</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate how well features are represented in the solution</span>
<span class="kw"><a href="https://prioritizr.net/reference/feature_representation.html">feature_representation</a></span>(p01, p01_sol)</code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature        absolute_held relative_held
##    &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
##  1 bio_nspp             667.          0.122  
##  2 bio_rls              719.          0.122  
##  3 phys_seamounts      2783.          0.740  
##  4 phys_vents            31.7         0.703  
##  5 phys_scape1          439.          0.0286 
##  6 phys_scape2         1102.          0.0607 
##  7 phys_scape3          912.          0.0744 
##  8 phys_scape4         1969.          0.168  
##  9 phys_scape5         1460.          0.188  
## 10 phys_scape6          612.          0.292  
## 11 phys_scape7            0.444       0.00145
## 12 phys_scape8          278.          0.259  
## 13 phys_scape9           68.4         0.0763 
## 14 phys_scape10           8.60        0.745  
## 15 phys_scape11         705.          0.241</code></pre>
<p>Strategy:</p>
<ol style="list-style-type: decimal">
<li>Solve for <code><a href="https://prioritizr.net/reference/add_max_utility_objective.html">add_max_utility_objective(budget = 0.1)</a></code> to determine max relative targets for:</li>
</ol>
<ul>
<li>all targets: min</li>
<li>ea target: max</li>
</ul>
<ol style="list-style-type: decimal">
<li>Switch to <code><a href="https://prioritizr.net/reference/add_max_features_objective.html">add_max_features_objective(budget = 0.1)</a></code> + <code><a href="https://prioritizr.net/reference/add_relative_targets.html">add_relative_targets(c(0.3, 0.3, 0))</a></code>
</li>
<li><ul>
<li>
<code><a href="https://prioritizr.net/reference/add_feature_weights.html">add_feature_weights()</a></code> to balance out</li>
</ul></li>
<li>add BLM</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p01_diagnostics &lt;-<span class="st"> </span><span class="kw"><a href="../reference/problem_diagnostics.html">problem_diagnostics</a></span>(r_pu_areas, p01_features, <span class="dt">budget=</span><span class="fl">0.1</span>)
p01_diagnostics <span class="co">#View(p01_diagnostics)</span></code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature        rel_all rel_each
##    &lt;chr&gt;            &lt;dbl&gt;    &lt;dbl&gt;
##  1 bio_nspp       0.122      0.181
##  2 bio_rls        0.122      0.183
##  3 phys_seamounts 0.740      0.783
##  4 phys_vents     0.703      1.   
##  5 phys_scape1    0.0286     0.491
##  6 phys_scape2    0.0607     0.416
##  7 phys_scape3    0.0744     0.616
##  8 phys_scape4    0.168      0.629
##  9 phys_scape5    0.188      0.630
## 10 phys_scape6    0.292      1.000
## 11 phys_scape7    0.00145    1.000
## 12 phys_scape8    0.259      1.000
## 13 phys_scape9    0.0763     1.000
## 14 phys_scape10   0.745      1    
## 15 phys_scape11   0.241      0.984</code></pre>
</div>
<div id="p02-biodiversity-centric-10-max-features" class="section level3">
<h3 class="hasAnchor">
<a href="#p02-biodiversity-centric-10-max-features" class="anchor"></a>p02: Biodiversity Centric, 10%, max features</h3>
<p>If relative target exceeds amount available, ie p01_diagnostics$rel_each, then target gets essentially dropped, so set to some compromise between full solution (rel_all) and max amount if just that feature chosen (rel_each) as the mean of the two. Do not excessively weight other features, so cap to 0.2 or similar with min.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p02_targets &lt;-<span class="st"> </span>p01_diagnostics <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">rel_mean =</span> (rel_all <span class="op">+</span><span class="st"> </span>rel_each) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>,
    <span class="dt">target   =</span> <span class="kw">map_dbl</span>(rel_mean, <span class="cf">function</span>(x) <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(x, <span class="fl">0.2</span>)))
p02_targets</code></pre></div>
<pre><code>## # A tibble: 15 x 5
##    feature        rel_all rel_each rel_mean target
##    &lt;chr&gt;            &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
##  1 bio_nspp       0.122      0.181    0.151  0.151
##  2 bio_rls        0.122      0.183    0.153  0.153
##  3 phys_seamounts 0.740      0.783    0.762  0.2  
##  4 phys_vents     0.703      1.       0.851  0.2  
##  5 phys_scape1    0.0286     0.491    0.260  0.2  
##  6 phys_scape2    0.0607     0.416    0.239  0.2  
##  7 phys_scape3    0.0744     0.616    0.345  0.2  
##  8 phys_scape4    0.168      0.629    0.399  0.2  
##  9 phys_scape5    0.188      0.630    0.409  0.2  
## 10 phys_scape6    0.292      1.000    0.646  0.2  
## 11 phys_scape7    0.00145    1.000    0.501  0.2  
## 12 phys_scape8    0.259      1.000    0.629  0.2  
## 13 phys_scape9    0.0763     1.000    0.538  0.2  
## 14 phys_scape10   0.745      1        0.872  0.2  
## 15 phys_scape11   0.241      0.984    0.613  0.2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p02 &lt;-<span class="st"> </span><span class="kw"><a href="https://prioritizr.net/reference/problem.html">problem</a></span>(r_pu_areas, p01_features) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_max_features_objective.html">add_max_features_objective</a></span>(<span class="dt">budget =</span> <span class="fl">0.1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_relative_targets.html">add_relative_targets</a></span>(<span class="kw">pull</span>(p02_targets, target)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_gurobi_solver.html">add_gurobi_solver</a></span>()
p02_sol &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solve_log.html">solve_log</a></span>(p02, <span class="dt">redo=</span>F)

<span class="co"># plot solution</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(p02_sol, <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"grey90"</span>, <span class="st">"darkgreen"</span>), <span class="dt">main =</span> <span class="st">"p02 solution"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-22-1.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># area of solution</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/cellStats">cellStats</a></span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p02_sol, <span class="st">"sum"</span>)</code></pre></div>
<pre><code>## [1] 0.09996667</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate how well features are represented in the solution</span>
<span class="kw"><a href="https://prioritizr.net/reference/feature_representation.html">feature_representation</a></span>(p02, p02_sol)</code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature        absolute_held relative_held
##    &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
##  1 bio_nspp              829.           0.151
##  2 bio_rls               899.           0.153
##  3 phys_seamounts        759.           0.202
##  4 phys_vents              9.71         0.215
##  5 phys_scape1             0            0    
##  6 phys_scape2             0            0    
##  7 phys_scape3          2194.           0.179
##  8 phys_scape4          2343.           0.200
##  9 phys_scape5          1554.           0.200
## 10 phys_scape6           419.           0.200
## 11 phys_scape7            61.8          0.202
## 12 phys_scape8           215.           0.200
## 13 phys_scape9           179.           0.200
## 14 phys_scape10            2.71         0.234
## 15 phys_scape11          585.           0.200</code></pre>
</div>
<div id="p03-biodiversity-centric-10-max-features-with-weights" class="section level3">
<h3 class="hasAnchor">
<a href="#p03-biodiversity-centric-10-max-features-with-weights" class="anchor"></a>p03: Biodiversity Centric, 10%, max features with weights</h3>
<p>Maximize overall biodiversity, given a budget of 10% of all high seas area.</p>
<p>Try to include missed phys_scape1 and phys_scape2 by adding weight.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p03 &lt;-<span class="st"> </span><span class="kw"><a href="https://prioritizr.net/reference/problem.html">problem</a></span>(r_pu_areas, p01_features) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_max_features_objective.html">add_max_features_objective</a></span>(<span class="dt">budget =</span> <span class="fl">0.1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_relative_targets.html">add_relative_targets</a></span>(<span class="kw">pull</span>(p02_targets, target)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_feature_weights.html">add_feature_weights</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span>, <span class="dv">7</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_gurobi_solver.html">add_gurobi_solver</a></span>()
p03_sol &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solve_log.html">solve_log</a></span>(p03, <span class="dt">redo=</span>F)

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(p03_sol, <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"grey90"</span>, <span class="st">"darkgreen"</span>), <span class="dt">main =</span> <span class="st">"p03 solution"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-23-1.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/cellStats">cellStats</a></span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p03_sol, <span class="st">"sum"</span>)</code></pre></div>
<pre><code>## [1] 0.09999678</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://prioritizr.net/reference/feature_representation.html">feature_representation</a></span>(p03, p03_sol)</code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature        absolute_held relative_held
##    &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
##  1 bio_nspp              829.        0.151   
##  2 bio_rls               899.        0.153   
##  3 phys_seamounts        752.        0.200   
##  4 phys_vents              9.43      0.209   
##  5 phys_scape1          3076.        0.200   
##  6 phys_scape2           661.        0.0364  
##  7 phys_scape3            11.0       0.000897
##  8 phys_scape4          2343.        0.200   
##  9 phys_scape5             1.11      0.000143
## 10 phys_scape6           419.        0.200   
## 11 phys_scape7            61.3       0.200   
## 12 phys_scape8           216.        0.201   
## 13 phys_scape9           179.        0.200   
## 14 phys_scape10            2.71      0.235   
## 15 phys_scape11          584.        0.200</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/problem_diagnostics.html">problem_diagnostics</a></span>(r_pu_areas, p01_features, <span class="dt">budget=</span><span class="fl">0.3</span>, <span class="dt">pfx=</span><span class="st">"p05"</span>)</code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature        rel_all rel_each
##    &lt;chr&gt;            &lt;dbl&gt;    &lt;dbl&gt;
##  1 bio_nspp         0.403    0.462
##  2 bio_rls          0.405    0.482
##  3 phys_seamounts   0.996    1.000
##  4 phys_vents       0.987    1.   
##  5 phys_scape1      0.144    1.000
##  6 phys_scape2      0.261    0.995
##  7 phys_scape3      0.367    1.   
##  8 phys_scape4      0.368    1.000
##  9 phys_scape5      0.425    0.997
## 10 phys_scape6      0.564    1.000
## 11 phys_scape7      0.167    1.000
## 12 phys_scape8      0.621    1.000
## 13 phys_scape9      0.285    1.000
## 14 phys_scape10     0.830    1    
## 15 phys_scape11     0.493    1.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p01_diagnostics &lt;-<span class="st"> </span><span class="kw"><a href="../reference/problem_diagnostics.html">problem_diagnostics</a></span>(r_pu_areas, p01_features, <span class="dt">budget=</span><span class="fl">0.1</span>)
p01_diagnostics <span class="co">#View(p01_diagnostics)</span></code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature        rel_all rel_each
##    &lt;chr&gt;            &lt;dbl&gt;    &lt;dbl&gt;
##  1 bio_nspp       0.122      0.181
##  2 bio_rls        0.122      0.183
##  3 phys_seamounts 0.740      0.783
##  4 phys_vents     0.703      1.   
##  5 phys_scape1    0.0286     0.491
##  6 phys_scape2    0.0607     0.416
##  7 phys_scape3    0.0744     0.616
##  8 phys_scape4    0.168      0.629
##  9 phys_scape5    0.188      0.630
## 10 phys_scape6    0.292      1.000
## 11 phys_scape7    0.00145    1.000
## 12 phys_scape8    0.259      1.000
## 13 phys_scape9    0.0763     1.000
## 14 phys_scape10   0.745      1    
## 15 phys_scape11   0.241      0.984</code></pre>
</div>
<div id="p04-biodiversity-centric-10-max-utility-with-blm" class="section level3">
<h3 class="hasAnchor">
<a href="#p04-biodiversity-centric-10-max-utility-with-blm" class="anchor"></a>p04: Biodiversity Centric, 10%, max utility with BLM</h3>
<p>Add clumping.</p>
<p>From the <a href="https://drive.google.com/file/d/1QIOA7hzYDgvjeVdqPfK6HzfDLrZCWIXd/view?usp=sharing">marxan manual 1.8.10.pdf</a> (p. 22-23):</p>
<blockquote>
<p>3.2.1.1.2 Boundary Length Modifier As a very rough guide, a good starting place for the BLM is to scale it such that the largest boundary between planning units becomes a similar order of magnitude to the most expensive planning unit. For instance, if your highest planning unit cost is 100 and your longest boundary is 1000, you may want to start the BLM at 0.1. Note that it is usually best to explore a range of values that are separated using a fixed multiplier; e.g., 0.04, 0.2, 1, 5, 25 – where in this example, these values are each multiplied by 5. Typically, the values are increased exponentially or by orders of magnitude in order to sample a range of values and choose one that balances the order of magnitude of competing terms of the objective function.</p>
</blockquote>
<p>Using same formulation as p01 + BLM.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set clumping parameter based on BLM advice in Marxan manual, exp't with p01</span>
blm &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/cellStats">cellStats</a></span>(r_pu_areas, <span class="st">"max"</span>) <span class="op">/</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="dv">10000</span>
blm</code></pre></div>
<pre><code>## [1] 0.2647405</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p04 &lt;-<span class="st"> </span><span class="kw"><a href="https://prioritizr.net/reference/problem.html">problem</a></span>(r_pu_areas, p01_features) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_max_utility_objective.html">add_max_utility_objective</a></span>(<span class="dt">budget =</span> <span class="fl">0.1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_boundary_penalties.html">add_boundary_penalties</a></span>(blm, <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_gurobi_solver.html">add_gurobi_solver</a></span>()

p04_sol &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solve_log.html">solve_log</a></span>(p04, <span class="dt">redo=</span>F)

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(p04_sol, <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"grey90"</span>, <span class="st">"darkgreen"</span>), <span class="dt">main =</span> <span class="st">"p04 solution"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-25-1.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/cellStats">cellStats</a></span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p04_sol, <span class="st">"sum"</span>)</code></pre></div>
<pre><code>## [1] 0.09999998</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://prioritizr.net/reference/feature_representation.html">feature_representation</a></span>(p04, p04_sol)</code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature        absolute_held relative_held
##    &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
##  1 bio_nspp               815.         0.149 
##  2 bio_rls                869.         0.148 
##  3 phys_seamounts        1386.         0.369 
##  4 phys_vents              20.1        0.446 
##  5 phys_scape1            205.         0.0133
##  6 phys_scape2            977.         0.0538
##  7 phys_scape3            565.         0.0460
##  8 phys_scape4           2675.         0.228 
##  9 phys_scape5           1241.         0.160 
## 10 phys_scape6            528.         0.252 
## 11 phys_scape7              0          0     
## 12 phys_scape8            333.         0.310 
## 13 phys_scape9            126.         0.141 
## 14 phys_scape10            11.6        1     
## 15 phys_scape11           893.         0.306</code></pre>
</div>
<div id="p05-biodiversity-centric-30-max-utility" class="section level3">
<h3 class="hasAnchor">
<a href="#p05-biodiversity-centric-30-max-utility" class="anchor"></a>p05: Biodiversity Centric, 30%, max utility</h3>
<p>Maximize diversity of species and habitats, given a budget of 30% of the high seas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p05 &lt;-<span class="st"> </span><span class="kw"><a href="https://prioritizr.net/reference/problem.html">problem</a></span>(r_pu_areas, p01_features) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_max_utility_objective.html">add_max_utility_objective</a></span>(<span class="dt">budget =</span> <span class="fl">0.3</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_gurobi_solver.html">add_gurobi_solver</a></span>()

p05_sol &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solve_log.html">solve_log</a></span>(p05, <span class="dt">redo=</span>F)

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(p05_sol, <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"grey90"</span>, <span class="st">"darkgreen"</span>), <span class="dt">main =</span> <span class="st">"p05 Solution"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-26-1.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/cellStats">cellStats</a></span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p05_sol, <span class="st">"sum"</span>)</code></pre></div>
<pre><code>## [1] 0.2999999</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://prioritizr.net/reference/feature_representation.html">feature_representation</a></span>(p05, p05_sol)</code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature        absolute_held relative_held
##    &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
##  1 bio_nspp             2209.           0.403
##  2 bio_rls              2385.           0.405
##  3 phys_seamounts       3742.           0.996
##  4 phys_vents             44.6          0.987
##  5 phys_scape1          2210.           0.144
##  6 phys_scape2          4734.           0.261
##  7 phys_scape3          4505.           0.367
##  8 phys_scape4          4308.           0.368
##  9 phys_scape5          3298.           0.425
## 10 phys_scape6          1183.           0.564
## 11 phys_scape7            51.3          0.167
## 12 phys_scape8           668.           0.621
## 13 phys_scape9           255.           0.285
## 14 phys_scape10            9.59         0.830
## 15 phys_scape11         1441.           0.493</code></pre>
</div>
<div id="p06-fisheries-centric-10-max-utility" class="section level3">
<h3 class="hasAnchor">
<a href="#p06-fisheries-centric-10-max-utility" class="anchor"></a>p06: Fisheries Centric, 10%, max utility</h3>
<p>Goal: Protect habitats with strong focus on minimizing impacts to fishing profits.</p>
<ul>
<li>To have inverse fishing as a target</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p06_features &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/stack">stack</a></span>(
  r_fish_gfw.profit.subsidies_inv,
  <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(s_fish_ubc_inv, <span class="st">"mcp_2004"</span>),
  <span class="kw"><a href="../reference/rescale_raster.html">rescale_raster</a></span>(r_phys_seamounts),
  <span class="kw"><a href="../reference/rescale_raster.html">rescale_raster</a></span>(r_phys_vents),
  <span class="kw"><a href="../reference/rescale_stack.html">rescale_stack</a></span>(s_phys_scapes))
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/names">names</a></span>(p06_features) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(
  <span class="st">"fish_profit.subs"</span>, 
  <span class="st">"fish_mcp.now"</span>,
  <span class="st">"phys_seamounts"</span>,
  <span class="st">"phys_vents"</span>,
  <span class="kw"><a href="https://www.rdocumentation.org/packages/glue/topics/glue">glue</a></span>(<span class="st">"phys_scape{1:11}"</span>))
<span class="co"># hist(r_nspp_all_as); hist(r_rls_all_as); hist(rescale_raster(r_phys_seamounts))</span>

p06_sum &lt;-<span class="st"> </span>raster<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/stackApply">stackApply</a></span>(p06_features, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/nlayers">nlayers</a></span>(p06_features)), sum) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/mask">mask</a></span>(r_pu_id)
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(p06_sum, <span class="dt">col=</span>cols)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-27-1.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p06 &lt;-<span class="st"> </span><span class="kw"><a href="https://prioritizr.net/reference/problem.html">problem</a></span>(r_pu_areas, p06_features) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_max_utility_objective.html">add_max_utility_objective</a></span>(<span class="dt">budget =</span> <span class="fl">0.1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># 10% of total high seas area</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_gurobi_solver.html">add_gurobi_solver</a></span>()
p06_sol &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solve_log.html">solve_log</a></span>(p06, <span class="dt">redo=</span>F)

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(p06_sol, <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"grey90"</span>, <span class="st">"darkgreen"</span>), <span class="dt">main =</span> <span class="st">"p06 solution"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-27-2.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/cellStats">cellStats</a></span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p06_sol, <span class="st">"sum"</span>)</code></pre></div>
<pre><code>## [1] 0.09999991</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://prioritizr.net/reference/feature_representation.html">feature_representation</a></span>(p06, p06_sol)</code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature          absolute_held relative_held
##    &lt;chr&gt;                    &lt;dbl&gt;         &lt;dbl&gt;
##  1 fish_profit.subs     26247.         0.272   
##  2 fish_mcp.now         24886.         0.253   
##  3 phys_seamounts         681.         0.181   
##  4 phys_vents               2.00       0.0443  
##  5 phys_scape1              4.11       0.000267
##  6 phys_scape2           3262.         0.180   
##  7 phys_scape3             18.9        0.00154 
##  8 phys_scape4           1669.         0.142   
##  9 phys_scape5            510.         0.0656  
## 10 phys_scape6             50.2        0.0239  
## 11 phys_scape7              0.636      0.00208 
## 12 phys_scape8              5.71       0.00531 
## 13 phys_scape9            131.         0.146   
## 14 phys_scape10             0          0       
## 15 phys_scape11           288.         0.0987</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p06_diagnostics &lt;-<span class="st"> </span><span class="kw"><a href="../reference/problem_diagnostics.html">problem_diagnostics</a></span>(r_pu_areas, p06_features, <span class="dt">budget=</span><span class="fl">0.1</span>)
p06_diagnostics</code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature           rel_all rel_each
##    &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
##  1 fish_profit.subs 0.272       0.298
##  2 fish_mcp.now     0.253       0.259
##  3 phys_seamounts   0.181       0.783
##  4 phys_vents       0.0443      1.   
##  5 phys_scape1      0.000267    0.491
##  6 phys_scape2      0.180       0.416
##  7 phys_scape3      0.00154     0.616
##  8 phys_scape4      0.142       0.629
##  9 phys_scape5      0.0656      0.630
## 10 phys_scape6      0.0239      1.000
## 11 phys_scape7      0.00208     1.000
## 12 phys_scape8      0.00531     1.000
## 13 phys_scape9      0.146       1.000
## 14 phys_scape10     0           1    
## 15 phys_scape11     0.0987      0.984</code></pre>
<p>Strategy:</p>
<ol style="list-style-type: decimal">
<li>Solve for <code><a href="https://prioritizr.net/reference/add_max_utility_objective.html">add_max_utility_objective(budget = 0.1)</a></code> to determine max relative targets for:</li>
</ol>
<ul>
<li>all targets: min</li>
<li>ea target: max</li>
</ul>
<ol style="list-style-type: decimal">
<li>Switch to <code><a href="https://prioritizr.net/reference/add_max_features_objective.html">add_max_features_objective(budget = 0.1)</a></code> + <code><a href="https://prioritizr.net/reference/add_relative_targets.html">add_relative_targets(c(0.3, 0.3, 0))</a></code>
</li>
<li><ul>
<li>
<code><a href="https://prioritizr.net/reference/add_feature_weights.html">add_feature_weights()</a></code> to balance out</li>
</ul></li>
<li>add BLM</li>
</ol>
</div>
<div id="p07-fisheries-centric-30-max-utility" class="section level3">
<h3 class="hasAnchor">
<a href="#p07-fisheries-centric-30-max-utility" class="anchor"></a>p07: Fisheries Centric, 30%, max utility</h3>
<p>Goal: Protect habitats with strong focus on minimizing impacts to fishing profits.</p>
<ul>
<li>To have inverse fishing as a target</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p07 &lt;-<span class="st"> </span><span class="kw"><a href="https://prioritizr.net/reference/problem.html">problem</a></span>(r_pu_areas, p06_features) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_max_utility_objective.html">add_max_utility_objective</a></span>(<span class="dt">budget =</span> <span class="fl">0.3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># 10% of total high seas area</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_gurobi_solver.html">add_gurobi_solver</a></span>()
p07_sol &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solve_log.html">solve_log</a></span>(p07, <span class="dt">redo=</span>F)

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(p07_sol, <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"grey90"</span>, <span class="st">"darkgreen"</span>), <span class="dt">main =</span> <span class="st">"p07 solution"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-28-1.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/cellStats">cellStats</a></span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p07_sol, <span class="st">"sum"</span>)</code></pre></div>
<pre><code>## [1] 0.3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://prioritizr.net/reference/feature_representation.html">feature_representation</a></span>(p07, p07_sol)</code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature          absolute_held relative_held
##    &lt;chr&gt;                    &lt;dbl&gt;         &lt;dbl&gt;
##  1 fish_profit.subs       50429.         0.523 
##  2 fish_mcp.now           46622.         0.474 
##  3 phys_seamounts          1743.         0.464 
##  4 phys_vents                17.1        0.380 
##  5 phys_scape1             1536.         0.0998
##  6 phys_scape2             8041.         0.443 
##  7 phys_scape3             1245.         0.102 
##  8 phys_scape4             6165.         0.526 
##  9 phys_scape5             1827.         0.235 
## 10 phys_scape6              369.         0.176 
## 11 phys_scape7               38.2        0.125 
## 12 phys_scape8               93.1        0.0866
## 13 phys_scape9              380.         0.424 
## 14 phys_scape10               0          0     
## 15 phys_scape11            1023.         0.350</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p07_diagnostics &lt;-<span class="st"> </span><span class="kw"><a href="../reference/problem_diagnostics.html">problem_diagnostics</a></span>(r_pu_areas, p06_features, <span class="dt">budget=</span><span class="fl">0.3</span>, <span class="dt">pfx=</span><span class="st">"p07"</span>)
p07_diagnostics</code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature          rel_all rel_each
##    &lt;chr&gt;              &lt;dbl&gt;    &lt;dbl&gt;
##  1 fish_profit.subs  0.523     0.553
##  2 fish_mcp.now      0.474     0.490
##  3 phys_seamounts    0.464     1.000
##  4 phys_vents        0.380     1.   
##  5 phys_scape1       0.0998    1.000
##  6 phys_scape2       0.443     0.995
##  7 phys_scape3       0.102     1.   
##  8 phys_scape4       0.526     1.000
##  9 phys_scape5       0.235     0.997
## 10 phys_scape6       0.176     1.000
## 11 phys_scape7       0.125     1.000
## 12 phys_scape8       0.0866    1.000
## 13 phys_scape9       0.424     1.000
## 14 phys_scape10      0         1    
## 15 phys_scape11      0.350     1.</code></pre>
</div>
<div id="p08-integrated-10-max-utility" class="section level3">
<h3 class="hasAnchor">
<a href="#p08-integrated-10-max-utility" class="anchor"></a>p08: Integrated, 10%, max utility</h3>
<p>Integrated “kitchen sink”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p08_features &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/stack">stack</a></span>(
  r_nspp_all_as,
  r_rls_all_as,
  r_fish_gfw.profit.subsidies_inv,
  <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(s_fish_ubc_inv, <span class="st">"mcp_2004"</span>),
  <span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(s_fish_ubc_inv, <span class="st">"mcp_2050"</span>),
  <span class="kw"><a href="../reference/rescale_raster.html">rescale_raster</a></span>(r_phys_seamounts),
  <span class="kw"><a href="../reference/rescale_raster.html">rescale_raster</a></span>(r_phys_vents),
  <span class="kw"><a href="../reference/rescale_stack.html">rescale_stack</a></span>(s_phys_scapes))
<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/names">names</a></span>(p08_features) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(
  <span class="st">"bio_nspp"</span>, 
  <span class="st">"bio_rls"</span>,
  <span class="st">"fish_profit.subs"</span>, 
  <span class="st">"fish_mcp.now"</span>,
  <span class="st">"fish_mcp.future"</span>,
  <span class="st">"phys_seamounts"</span>,
  <span class="st">"phys_vents"</span>,
  <span class="kw"><a href="https://www.rdocumentation.org/packages/glue/topics/glue">glue</a></span>(<span class="st">"phys_scape{1:11}"</span>))

p08 &lt;-<span class="st"> </span><span class="kw"><a href="https://prioritizr.net/reference/problem.html">problem</a></span>(r_pu_areas, p08_features) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_max_utility_objective.html">add_max_utility_objective</a></span>(<span class="dt">budget =</span> <span class="fl">0.1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># 10% of total high seas area</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_gurobi_solver.html">add_gurobi_solver</a></span>()
p08_sol &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solve_log.html">solve_log</a></span>(p08, <span class="dt">redo=</span>F)

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(p08_sol, <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"grey90"</span>, <span class="st">"darkgreen"</span>), <span class="dt">main =</span> <span class="st">"p08 solution"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-29-1.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/cellStats">cellStats</a></span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p08_sol, <span class="st">"sum"</span>)</code></pre></div>
<pre><code>## [1] 0.09999991</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://prioritizr.net/reference/feature_representation.html">feature_representation</a></span>(p08, p08_sol)</code></pre></div>
<pre><code>## # A tibble: 18 x 3
##    feature          absolute_held relative_held
##    &lt;chr&gt;                    &lt;dbl&gt;         &lt;dbl&gt;
##  1 bio_nspp                93.2        0.0170  
##  2 bio_rls                150.         0.0256  
##  3 fish_profit.subs     25567.         0.265   
##  4 fish_mcp.now         25302.         0.257   
##  5 fish_mcp.future      25280.         0.257   
##  6 phys_seamounts         579.         0.154   
##  7 phys_vents               1.86       0.0411  
##  8 phys_scape1              3.68       0.000239
##  9 phys_scape2           3380.         0.186   
## 10 phys_scape3             24.8        0.00202 
## 11 phys_scape4           1686.         0.144   
## 12 phys_scape5            514.         0.0661  
## 13 phys_scape6             56.3        0.0269  
## 14 phys_scape7              0.636      0.00208 
## 15 phys_scape8              5.40       0.00503 
## 16 phys_scape9            158.         0.176   
## 17 phys_scape10             0          0       
## 18 phys_scape11           296.         0.101</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p08_diagnostics &lt;-<span class="st"> </span><span class="kw"><a href="../reference/problem_diagnostics.html">problem_diagnostics</a></span>(r_pu_areas, p08_features, <span class="dt">budget=</span><span class="fl">0.1</span>, <span class="dt">redo=</span>F)
p08_diagnostics</code></pre></div>
<pre><code>## # A tibble: 18 x 3
##    feature           rel_all rel_each
##    &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt;
##  1 bio_nspp         0.0170      0.181
##  2 bio_rls          0.0256      0.183
##  3 fish_profit.subs 0.265       0.298
##  4 fish_mcp.now     0.257       0.259
##  5 fish_mcp.future  0.257       0.259
##  6 phys_seamounts   0.154       0.783
##  7 phys_vents       0.0411      1.   
##  8 phys_scape1      0.000239    0.491
##  9 phys_scape2      0.186       0.416
## 10 phys_scape3      0.00202     0.616
## 11 phys_scape4      0.144       0.629
## 12 phys_scape5      0.0661      0.630
## 13 phys_scape6      0.0269      1.000
## 14 phys_scape7      0.00208     1.000
## 15 phys_scape8      0.00503     1.000
## 16 phys_scape9      0.176       1.000
## 17 phys_scape10     0           1    
## 18 phys_scape11     0.101       0.984</code></pre>
</div>
<div id="p09-biodiversity-centric-10-max-utility-with-weights" class="section level3">
<h3 class="hasAnchor">
<a href="#p09-biodiversity-centric-10-max-utility-with-weights" class="anchor"></a>p09: Biodiversity Centric, 10%, max utility with weights</h3>
<p>Maximize overall biodiversity, given a budget of 10% of all high seas area.</p>
<p>Try to include missed phys_scape1 and phys_scape2 by adding weight.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p09 &lt;-<span class="st"> </span><span class="kw"><a href="https://prioritizr.net/reference/problem.html">problem</a></span>(r_pu_areas, p01_features) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_max_utility_objective.html">add_max_utility_objective</a></span>(<span class="dt">budget =</span> <span class="fl">0.1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_feature_weights.html">add_feature_weights</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span>, <span class="dv">11</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_gurobi_solver.html">add_gurobi_solver</a></span>()

p09_sol &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solve_log.html">solve_log</a></span>(p09, <span class="dt">redo=</span>T)

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(p09_sol, <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"grey90"</span>, <span class="st">"darkgreen"</span>), <span class="dt">main =</span> <span class="st">"p09 solution"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-30-1.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/cellStats">cellStats</a></span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p09_sol, <span class="st">"sum"</span>)</code></pre></div>
<pre><code>## [1] 0.1000005</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://prioritizr.net/reference/feature_representation.html">feature_representation</a></span>(p09, p09_sol)</code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature        absolute_held relative_held
##    &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
##  1 bio_nspp              959.          0.175 
##  2 bio_rls              1045.          0.177 
##  3 phys_seamounts        927.          0.247 
##  4 phys_vents             18.0         0.399 
##  5 phys_scape1           441.          0.0287
##  6 phys_scape2          1606.          0.0885
##  7 phys_scape3          1121.          0.0914
##  8 phys_scape4          1510.          0.129 
##  9 phys_scape5           906.          0.117 
## 10 phys_scape6           549.          0.262 
## 11 phys_scape7            21.5         0.0701
## 12 phys_scape8           380.          0.353 
## 13 phys_scape9           189.          0.211 
## 14 phys_scape10            8.60        0.745 
## 15 phys_scape11          780.          0.267</code></pre>
</div>
<div id="p04-biodiversity-centric-10-max-utility-with-blm-1" class="section level3">
<h3 class="hasAnchor">
<a href="#p04-biodiversity-centric-10-max-utility-with-blm-1" class="anchor"></a>p04: Biodiversity Centric, 10%, max utility with BLM</h3>
<p>Add clumping.</p>
<p>From the <a href="https://drive.google.com/file/d/1QIOA7hzYDgvjeVdqPfK6HzfDLrZCWIXd/view?usp=sharing">marxan manual 1.8.10.pdf</a> (p. 22-23):</p>
<blockquote>
<p>3.2.1.1.2 Boundary Length Modifier As a very rough guide, a good starting place for the BLM is to scale it such that the largest boundary between planning units becomes a similar order of magnitude to the most expensive planning unit. For instance, if your highest planning unit cost is 100 and your longest boundary is 1000, you may want to start the BLM at 0.1. Note that it is usually best to explore a range of values that are separated using a fixed multiplier; e.g., 0.04, 0.2, 1, 5, 25 – where in this example, these values are each multiplied by 5. Typically, the values are increased exponentially or by orders of magnitude in order to sample a range of values and choose one that balances the order of magnitude of competing terms of the objective function.</p>
</blockquote>
<p>Using same formulation as p01 + BLM.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set clumping parameter based on BLM advice in Marxan manual, exp't with p01</span>
blm &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/cellStats">cellStats</a></span>(r_pu_areas, <span class="st">"max"</span>) <span class="op">/</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="dv">10000</span>
blm</code></pre></div>
<pre><code>## [1] 0.2647405</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p04 &lt;-<span class="st"> </span><span class="kw"><a href="https://prioritizr.net/reference/problem.html">problem</a></span>(r_pu_areas, p01_features) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_max_utility_objective.html">add_max_utility_objective</a></span>(<span class="dt">budget =</span> <span class="fl">0.1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_boundary_penalties.html">add_boundary_penalties</a></span>(blm, <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://prioritizr.net/reference/add_gurobi_solver.html">add_gurobi_solver</a></span>()

p04_sol &lt;-<span class="st"> </span><span class="kw"><a href="../reference/solve_log.html">solve_log</a></span>(p04, <span class="dt">redo=</span>F)

<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/plot">plot</a></span>(p04_sol, <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"grey90"</span>, <span class="st">"darkgreen"</span>), <span class="dt">main =</span> <span class="st">"p04 solution"</span>)</code></pre></div>
<p><img src="prioritizr_explore_files/figure-html/unnamed-chunk-31-1.png" width="691.2"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/cellStats">cellStats</a></span>(r_pu_areas <span class="op">*</span><span class="st"> </span>p04_sol, <span class="st">"sum"</span>)</code></pre></div>
<pre><code>## [1] 0.09999998</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://prioritizr.net/reference/feature_representation.html">feature_representation</a></span>(p04, p04_sol)</code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    feature        absolute_held relative_held
##    &lt;chr&gt;                  &lt;dbl&gt;         &lt;dbl&gt;
##  1 bio_nspp               815.         0.149 
##  2 bio_rls                869.         0.148 
##  3 phys_seamounts        1386.         0.369 
##  4 phys_vents              20.1        0.446 
##  5 phys_scape1            205.         0.0133
##  6 phys_scape2            977.         0.0538
##  7 phys_scape3            565.         0.0460
##  8 phys_scape4           2675.         0.228 
##  9 phys_scape5           1241.         0.160 
## 10 phys_scape6            528.         0.252 
## 11 phys_scape7              0          0     
## 12 phys_scape8            333.         0.310 
## 13 phys_scape9            126.         0.141 
## 14 phys_scape10            11.6        1     
## 15 phys_scape11           893.         0.306</code></pre>
</div>
</div>
<div id="todo-near-term" class="section level2">
<h2 class="hasAnchor">
<a href="#todo-near-term" class="anchor"></a>TODO: near-term</h2>
<ol style="list-style-type: decimal">
<li>
<a href="https://prioritizr.net/reference/add_locked_out_constraints.html">add_locked_out_constraints()</a> for mining leased areas</li>
<li>Explore <a href="https://prioritizr.net/reference/portfolios.html">Solution portfolios</a> solves for stack of alternative raster solutions.</li>
</ol>
<div id="refs" class="references">
<div id="ref-butchartImprovementsRedList2007">
<p>Butchart, Stuart H. M., H. Resit Akçakaya, Janice Chanson, Jonathan E. M. Baillie, Ben Collen, Suhel Quader, Will R. Turner, Rajan Amin, Simon N. Stuart, and Craig Hilton-Taylor. 2007. “Improvements to the Red List Index.” <em>PLOS ONE</em> 2 (1): e140. doi:<a href="https://doi.org/10.1371/journal.pone.0000140">10.1371/journal.pone.0000140</a>.</p>
</div>
<div id="ref-juslenApplicationRedList2016">
<p>Juslén, Aino, Juha Pykälä, Saija Kuusela, Lauri Kaila, Jaakko Kullberg, Jaakko Mattila, Jyrki Muona, Sanna Saari, and Pedro Cardoso. 2016. “Application of the Red List Index as an Indicator of Habitat Change.” <em>Biodivers Conserv</em> 25 (3): 569–85. doi:<a href="https://doi.org/10.1007/s10531-016-1075-0">10.1007/s10531-016-1075-0</a>.</p>
</div>
<div id="ref-kaschnerAquaMapsPredictedRange2016">
<p>Kaschner, K., K. Kesner-Reyes, C. Garilao, J. Rius-Barile, T. Rees, and R. Froese. 2016. “AquaMaps: Predicted Range Maps for Aquatic Species.” World Wide Web Electronic Publication.</p>
</div>
<div id="ref-kleinShortfallsGlobalProtected2015">
<p>Klein, Carissa J., Christopher J. Brown, Benjamin S. Halpern, Daniel B. Segan, Jennifer McGowan, Maria Beger, and James E. M. Watson. 2015. “Shortfalls in the Global Protected Area Network at Representing Marine Biodiversity.” <em>Scientific Reports</em> 5 (December): 17539. doi:<a href="https://doi.org/10.1038/srep17539">10.1038/srep17539</a>.</p>
</div>
<div id="ref-oharaAligningMarineSpecies2017">
<p>O’Hara, Casey C., Jamie C. Afflerbach, Courtney Scarborough, Kristin Kaschner, and Benjamin S. Halpern. 2017. “Aligning Marine Species Range Data to Better Serve Science and Conservation.” <em>PLOS ONE</em> 12 (5): e0175739. doi:<a href="https://doi.org/10.1371/journal.pone.0175739">10.1371/journal.pone.0175739</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#setup">Setup</a></li>
      <li><a href="#bbnj-data-sets">BBNJ data sets</a></li>
      <li>
<a href="#planning-units">Planning Units</a><ul class="nav nav-pills nav-stacked">
<li><a href="#pu-cost-as-area">PU Cost as Area</a></li>
      </ul>
</li>
      <li>
<a href="#conservation-targets">Conservation Targets</a><ul class="nav nav-pills nav-stacked">
<li>
<a href="#biodiversity">Biodiversity</a><ul class="nav nav-pills nav-stacked">
<li><a href="#nspp-all-taxa"><code>nspp</code>, all taxa</a></li>
      <li><a href="#nspp-all-taxa-area-scaled"><code>nspp</code>, all taxa, area scaled</a></li>
      <li><a href="#nspp-by-taxonomic-group"><code>nspp</code>, by taxonomic group</a></li>
      <li><a href="#rls-all-taxa"><code>rls</code>, all taxa</a></li>
      <li><a href="#rls-all-taxa-area-scaled"><code>rls</code>, all taxa, area scaled</a></li>
      <li><a href="#rls-by-taxonomic-group"><code>rls</code>, by taxonomic group</a></li>
      </ul>
</li>
      <li><a href="#physiographic-seamounts">Physiographic: Seamounts</a></li>
      <li><a href="#physiographic-benthic-seascapes">Physiographic: Benthic Seascapes</a></li>
      <li>
<a href="#fisheries-global-fishing-watch">Fisheries: Global Fishing Watch</a><ul class="nav nav-pills nav-stacked">
<li><a href="#gap-filling-fisheries-layer">Gap-Filling Fisheries Layer</a></li>
      <li><a href="#inverting-fisheries-for-conservation-target">Inverting Fisheries for Conservation Target</a></li>
      </ul>
</li>
      <li>
<a href="#fisheries-u-of-british-columbia">Fisheries: U of British Columbia</a><ul class="nav nav-pills nav-stacked">
<li><a href="#rescale-and-invert">Rescale and Invert</a></li>
      </ul>
</li>
      </ul>
</li>
      <li>
<a href="#priorization-scenarios">Priorization Scenarios</a><ul class="nav nav-pills nav-stacked">
<li><a href="#p01-biodiversity-centric-10-max-utility">p01: Biodiversity Centric, 10%, max utility</a></li>
      <li><a href="#p02-biodiversity-centric-10-max-features">p02: Biodiversity Centric, 10%, max features</a></li>
      <li><a href="#p03-biodiversity-centric-10-max-features-with-weights">p03: Biodiversity Centric, 10%, max features with weights</a></li>
      <li><a href="#p04-biodiversity-centric-10-max-utility-with-blm">p04: Biodiversity Centric, 10%, max utility with BLM</a></li>
      <li><a href="#p05-biodiversity-centric-30-max-utility">p05: Biodiversity Centric, 30%, max utility</a></li>
      <li><a href="#p06-fisheries-centric-10-max-utility">p06: Fisheries Centric, 10%, max utility</a></li>
      <li><a href="#p07-fisheries-centric-30-max-utility">p07: Fisheries Centric, 30%, max utility</a></li>
      <li><a href="#p08-integrated-10-max-utility">p08: Integrated, 10%, max utility</a></li>
      <li><a href="#p09-biodiversity-centric-10-max-utility-with-weights">p09: Biodiversity Centric, 10%, max utility with weights</a></li>
      <li><a href="#p04-biodiversity-centric-10-max-utility-with-blm-1">p04: Biodiversity Centric, 10%, max utility with BLM</a></li>
      </ul>
</li>
      <li><a href="#todo-near-term">TODO: near-term</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Ben Best.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
